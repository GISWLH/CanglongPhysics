# V1
Test set summary (precipitation & key variables):
Average precip PCC:  0.273677
Average precip ACC:  0.267193
Average precip RMSE (norm.): 1.911699
Combined score (mean PCC/ACC): 0.270435
Average avg_tnlwrf PCC: -0.721706, RMSE(norm.): 1.033073
Average t2m PCC:       0.718808, RMSE(norm.): 0.861110
Average d2m PCC:       0.663692, RMSE(norm.): 0.858292
Average u200 PCC:      0.784358, RMSE(norm.): 0.601693
Average u850 PCC:      0.760147, RMSE(norm.): 0.674795
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.640136
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.981518
Average surface RMSE(norm.):  11.692513
Average upper-air RMSE(norm.):0.729693

# V2
Test set summary (precipitation & key variables):
Average precip PCC:  0.390960
Average precip ACC:  0.387276
Average precip RMSE (norm.): 2.001374
Combined score (mean PCC/ACC): 0.389118
Average avg_tnlwrf PCC: -0.720285, RMSE(norm.): 1.035836
Average t2m PCC:       0.683905, RMSE(norm.): 0.857427
Average d2m PCC:       0.663958, RMSE(norm.): 0.848932
Average u200 PCC:      0.802999, RMSE(norm.): 0.581117
Average u850 PCC:      0.782264, RMSE(norm.): 0.637458
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.664817
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.985262
Average surface RMSE(norm.):  12.485459
Average upper-air RMSE(norm.):0.706013

# V2_1
Test set summary (precipitation & key variables):
Average precip PCC:  0.607889
Average precip ACC:  0.607212
Average precip RMSE (norm.): 1.518511
Combined score (mean PCC/ACC): 0.607550
Average avg_tnlwrf PCC: 0.920913, RMSE(norm.): 0.356980
Average t2m PCC:       0.979110, RMSE(norm.): 0.241549
Average d2m PCC:       0.973418, RMSE(norm.): 0.274640
Average u200 PCC:      0.827214, RMSE(norm.): 0.554742
Average u850 PCC:      0.803401, RMSE(norm.): 0.612474
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.838206
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.640383
Average surface RMSE(norm.):  0.802424
Average upper-air RMSE(norm.):0.689484

# V2_2
Test set summary (precipitation & key variables):
Average precip PCC:  0.604868
Average precip ACC:  0.604435
Average precip RMSE (norm.): 1.523630
Combined score (mean PCC/ACC): 0.604651
Average avg_tnlwrf PCC: 0.925175, RMSE(norm.): 0.348773
Average t2m PCC:       0.980692, RMSE(norm.): 0.240615
Average d2m PCC:       0.973565, RMSE(norm.): 0.281066
Average u200 PCC:      0.823402, RMSE(norm.): 0.563860
Average u850 PCC:      0.800494, RMSE(norm.): 0.618239
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.836604
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.645482
Average surface RMSE(norm.):  0.783036
Average upper-air RMSE(norm.):0.690527

# V2_3
Test set summary (precipitation & key variables):
Average precip PCC:  0.609142
Average precip ACC:  0.608767
Average precip RMSE (norm.): 1.515637
Combined score (mean PCC/ACC): 0.608955
Average avg_tnlwrf PCC: 0.923984, RMSE(norm.): 0.360788
Average t2m PCC:       0.977727, RMSE(norm.): 0.284400
Average d2m PCC:       0.969561, RMSE(norm.): 0.312203
Average u200 PCC:      0.826025, RMSE(norm.): 0.556684
Average u850 PCC:      0.794868, RMSE(norm.): 0.622531
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.835465
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.658291
Average surface RMSE(norm.):  0.801832
Average upper-air RMSE(norm.):0.689072

# V2_4
Test set summary (precipitation & key variables):
Average precip PCC:  0.591300
Average precip ACC:  0.588938
Average precip RMSE (norm.): 1.614629
Combined score (mean PCC/ACC): 0.590119
Average avg_tnlwrf PCC: 0.893630, RMSE(norm.): 0.412551
Average t2m PCC:       0.965691, RMSE(norm.): 0.241120
Average d2m PCC:       0.963197, RMSE(norm.): 0.247411
Average u200 PCC:      0.787322, RMSE(norm.): 0.609180
Average u850 PCC:      0.793338, RMSE(norm.): 0.634961
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.820170
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.669460
Average surface RMSE(norm.):  0.812475
Average upper-air RMSE(norm.):0.705916

# V2_5
Test set summary (precipitation & key variables):
Average precip PCC:  0.600954
Average precip ACC:  0.600841
Average precip RMSE (norm.): 1.530471
Combined score (mean PCC/ACC): 0.600898
Average avg_tnlwrf PCC: 0.920954, RMSE(norm.): 0.360687
Average t2m PCC:       0.979475, RMSE(norm.): 0.240186
Average d2m PCC:       0.972218, RMSE(norm.): 0.267247
Average u200 PCC:      0.799251, RMSE(norm.): 0.589106
Average u850 PCC:      0.796458, RMSE(norm.): 0.619871
Average grouped PCC (precip/t2m/d2m/u200/u850): 0.829671
Average grouped RMSE(norm.) (precip/t2m/d2m/u200/u850): 0.649376
Average surface RMSE(norm.):  0.787943
Average upper-air RMSE(norm.):0.692333

(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# python train_v2_3.py
Using device: cuda
Loading data...
Surface data shape: (52, 26, 721, 1440)
Upper air data shape: (52, 10, 5, 721, 1440)
Loading normalization parameters...
Surface mean shape: torch.Size([1, 26, 1, 721, 1440])
Upper mean shape: torch.Size([1, 10, 5, 1, 721, 1440])
Dataset from index 0 to 28, sample count: 26
Dataset from index 28 to 40, sample count: 10
Total training samples: 26
Total validation samples: 10
Mixed precision training: True
No checkpoint found. Starting fresh training.
======================================================================
Training V2.3 with Wind-Aware Per-Window Shift + Matching Attention Mask
======================================================================
Window size: (2, 6, 12)
Wind shift scale: 2
Wind speed threshold: 0.5 m/s
Top-K wind directions: 4
======================================================================
Epoch 1/50 [Train]:   0%|                                                                    | 0/26 [00:00<?, ?it/s]/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

  [Wind Direction Info]:
  wind_direction_id shape: torch.Size([1, 31, 30])
  Unique directions: ['None', 'N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW']
  Sample (5x5 windows):
    ['W', 'W', 'NW', 'NW', 'NW']
    ['SW', 'SW', 'W', 'NW', 'NW']
    ['SE', 'SE', 'E', 'NE', 'N']
    ['E', 'E', 'E', 'E', 'E']
    ['E', 'E', 'E', 'E', 'E']

Epoch 1/50 [Train]: 100%|███████████| 26/26 [01:31<00:00,  3.51s/it, loss=2.0995, surf=1.4774, upper=0.6220, wind=E]

Epoch 1/50
  Train - Total: 1.994108, Surface: 1.201980, Upper Air: 0.792128
Epoch 1/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:28<00:00,  2.89s/it]
  Valid - Total: 1.552732, Surface: 0.900687, Upper Air: 0.652045
Epoch 2/50 [Train]: 100%|███████████| 26/26 [01:27<00:00,  3.38s/it, loss=1.4421, surf=0.8621, upper=0.5800, wind=E]

Epoch 2/50
  Train - Total: 1.428395, Surface: 0.871719, Upper Air: 0.556676
Epoch 2/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.358380, Surface: 0.773509, Upper Air: 0.584871
Epoch 3/50 [Train]: 100%|███████████| 26/26 [01:34<00:00,  3.62s/it, loss=1.5182, surf=0.9396, upper=0.5786, wind=E]

Epoch 3/50
  Train - Total: 1.275888, Surface: 0.758344, Upper Air: 0.517544
Epoch 3/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.02s/it]
  Valid - Total: 1.297046, Surface: 0.740731, Upper Air: 0.556315
Epoch 4/50 [Train]: 100%|███████████| 26/26 [01:36<00:00,  3.71s/it, loss=1.0918, surf=0.5863, upper=0.5055, wind=E]

Epoch 4/50
  Train - Total: 1.209493, Surface: 0.709073, Upper Air: 0.500420
Epoch 4/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.249007, Surface: 0.711020, Upper Air: 0.537986
Epoch 5/50 [Train]: 100%|███████████| 26/26 [01:26<00:00,  3.33s/it, loss=0.9625, surf=0.5249, upper=0.4376, wind=E]

Epoch 5/50
  Train - Total: 1.169499, Surface: 0.676094, Upper Air: 0.493406
Epoch 5/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.07s/it]
  Valid - Total: 1.237272, Surface: 0.702839, Upper Air: 0.534433
Epoch 6/50 [Train]: 100%|███████████| 26/26 [01:33<00:00,  3.60s/it, loss=1.0619, surf=0.5912, upper=0.4707, wind=E]

Epoch 6/50
  Train - Total: 1.131592, Surface: 0.645982, Upper Air: 0.485609
Epoch 6/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.02s/it]
  Valid - Total: 1.255742, Surface: 0.727468, Upper Air: 0.528274
Epoch 7/50 [Train]: 100%|███████████| 26/26 [01:30<00:00,  3.50s/it, loss=1.3617, surf=0.7987, upper=0.5631, wind=E]

Epoch 7/50
  Train - Total: 1.120186, Surface: 0.640067, Upper Air: 0.480119
Epoch 7/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.217270, Surface: 0.694531, Upper Air: 0.522738
Epoch 8/50 [Train]: 100%|███████████| 26/26 [01:29<00:00,  3.45s/it, loss=0.8849, surf=0.4783, upper=0.4066, wind=E]

Epoch 8/50
  Train - Total: 1.090054, Surface: 0.614276, Upper Air: 0.475777
Epoch 8/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.94s/it]
  Valid - Total: 1.229343, Surface: 0.707621, Upper Air: 0.521722
Epoch 9/50 [Train]: 100%|███████████| 26/26 [01:30<00:00,  3.48s/it, loss=1.4277, surf=0.9296, upper=0.4980, wind=E]

Epoch 9/50
  Train - Total: 1.082585, Surface: 0.608238, Upper Air: 0.474347
Epoch 9/50 [Valid]: 100%|███████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.192218, Surface: 0.679978, Upper Air: 0.512240
Epoch 10/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.34s/it, loss=1.0135, surf=0.5914, upper=0.4221, wind=E]

Epoch 10/50
  Train - Total: 1.057124, Surface: 0.587016, Upper Air: 0.470108
Epoch 10/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.151673, Surface: 0.642586, Upper Air: 0.509087
Epoch 11/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.34s/it, loss=0.9612, surf=0.5496, upper=0.4117, wind=E]

Epoch 11/50
  Train - Total: 1.034333, Surface: 0.567647, Upper Air: 0.466686
Epoch 11/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.157445, Surface: 0.647613, Upper Air: 0.509832
Epoch 12/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.40s/it, loss=1.2605, surf=0.7070, upper=0.5535, wind=E]

Epoch 12/50
  Train - Total: 1.043398, Surface: 0.575861, Upper Air: 0.467537
Epoch 12/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.166019, Surface: 0.661450, Upper Air: 0.504570
Epoch 13/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.41s/it, loss=1.0572, surf=0.6187, upper=0.4384, wind=E]

Epoch 13/50
  Train - Total: 1.034408, Surface: 0.568268, Upper Air: 0.466140
Epoch 13/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.162240, Surface: 0.660629, Upper Air: 0.501611
Epoch 14/50 [Train]: 100%|██████████| 26/26 [01:34<00:00,  3.65s/it, loss=1.0425, surf=0.6050, upper=0.4374, wind=E]

Epoch 14/50
  Train - Total: 1.033208, Surface: 0.570096, Upper Air: 0.463112
Epoch 14/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.117668, Surface: 0.615641, Upper Air: 0.502027
Epoch 15/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.32s/it, loss=1.0036, surf=0.4958, upper=0.5078, wind=E]

Epoch 15/50
  Train - Total: 1.010077, Surface: 0.547795, Upper Air: 0.462282
Epoch 15/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.127188, Surface: 0.627781, Upper Air: 0.499406
Epoch 16/50 [Train]: 100%|██████████| 26/26 [01:33<00:00,  3.59s/it, loss=1.0185, surf=0.4554, upper=0.5631, wind=E]

Epoch 16/50
  Train - Total: 0.999585, Surface: 0.539725, Upper Air: 0.459860
Epoch 16/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.126830, Surface: 0.627849, Upper Air: 0.498981
Epoch 17/50 [Train]: 100%|██████████| 26/26 [01:29<00:00,  3.45s/it, loss=1.0734, surf=0.5657, upper=0.5077, wind=E]

Epoch 17/50
  Train - Total: 1.010388, Surface: 0.550761, Upper Air: 0.459627
Epoch 17/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.120227, Surface: 0.618878, Upper Air: 0.501350
Epoch 18/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.33s/it, loss=1.0186, surf=0.5838, upper=0.4348, wind=E]

Epoch 18/50
  Train - Total: 1.002458, Surface: 0.544252, Upper Air: 0.458205
Epoch 18/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.98s/it]
  Valid - Total: 1.122093, Surface: 0.625402, Upper Air: 0.496692
Epoch 19/50 [Train]: 100%|██████████| 26/26 [01:32<00:00,  3.57s/it, loss=0.8478, surf=0.4413, upper=0.4065, wind=E]

Epoch 19/50
  Train - Total: 0.983695, Surface: 0.528626, Upper Air: 0.455069
Epoch 19/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.92s/it]
  Valid - Total: 1.105959, Surface: 0.609118, Upper Air: 0.496841
Epoch 20/50 [Train]: 100%|██████████| 26/26 [01:25<00:00,  3.30s/it, loss=0.9880, surf=0.5660, upper=0.4220, wind=E]

Epoch 20/50
  Train - Total: 0.977575, Surface: 0.521416, Upper Air: 0.456159
Epoch 20/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.106591, Surface: 0.608177, Upper Air: 0.498414
Epoch 21/50 [Train]: 100%|██████████| 26/26 [01:33<00:00,  3.61s/it, loss=1.0002, surf=0.5135, upper=0.4867, wind=E]

Epoch 21/50
  Train - Total: 0.971412, Surface: 0.517028, Upper Air: 0.454383
Epoch 21/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.125750, Surface: 0.626659, Upper Air: 0.499092
Epoch 22/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.31s/it, loss=1.0311, surf=0.6058, upper=0.4253, wind=E]

Epoch 22/50
  Train - Total: 0.977071, Surface: 0.521801, Upper Air: 0.455270
Epoch 22/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.113506, Surface: 0.614858, Upper Air: 0.498648
Epoch 23/50 [Train]: 100%|██████████| 26/26 [01:31<00:00,  3.51s/it, loss=0.9538, surf=0.5264, upper=0.4274, wind=E]

Epoch 23/50
  Train - Total: 0.964576, Surface: 0.512472, Upper Air: 0.452104
Epoch 23/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.126358, Surface: 0.630208, Upper Air: 0.496150
Epoch 24/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.39s/it, loss=0.9313, surf=0.5274, upper=0.4039, wind=E]

Epoch 24/50
  Train - Total: 0.963373, Surface: 0.511573, Upper Air: 0.451800
Epoch 24/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.101529, Surface: 0.605720, Upper Air: 0.495809
Epoch 25/50 [Train]: 100%|██████████| 26/26 [01:32<00:00,  3.55s/it, loss=0.9707, surf=0.5438, upper=0.4269, wind=E]

Epoch 25/50
  Train - Total: 0.960213, Surface: 0.507762, Upper Air: 0.452452
Epoch 25/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.94s/it]
  Valid - Total: 1.125165, Surface: 0.627991, Upper Air: 0.497174
  Saved checkpoint: checkpoints_v2_3/model_v2_3_epoch25.pth
Epoch 26/50 [Train]: 100%|██████████| 26/26 [01:30<00:00,  3.49s/it, loss=1.0058, surf=0.5789, upper=0.4269, wind=E]

Epoch 26/50
  Train - Total: 0.964001, Surface: 0.513062, Upper Air: 0.450940
Epoch 26/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.118883, Surface: 0.618859, Upper Air: 0.500024
Epoch 27/50 [Train]: 100%|██████████| 26/26 [01:33<00:00,  3.59s/it, loss=0.8647, surf=0.4624, upper=0.4023, wind=E]

Epoch 27/50
  Train - Total: 0.964590, Surface: 0.512400, Upper Air: 0.452190
Epoch 27/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.096611, Surface: 0.600049, Upper Air: 0.496562
Epoch 28/50 [Train]: 100%|██████████| 26/26 [01:33<00:00,  3.61s/it, loss=1.1397, surf=0.6066, upper=0.5330, wind=E]

Epoch 28/50
  Train - Total: 0.953007, Surface: 0.504173, Upper Air: 0.448834
Epoch 28/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.109730, Surface: 0.616155, Upper Air: 0.493575
Epoch 29/50 [Train]: 100%|██████████| 26/26 [01:27<00:00,  3.38s/it, loss=0.7921, surf=0.3931, upper=0.3990, wind=E]

Epoch 29/50
  Train - Total: 0.941334, Surface: 0.494417, Upper Air: 0.446917
Epoch 29/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.01s/it]
  Valid - Total: 1.085190, Surface: 0.591943, Upper Air: 0.493247
Epoch 30/50 [Train]: 100%|██████████| 26/26 [01:31<00:00,  3.54s/it, loss=0.8494, surf=0.4558, upper=0.3936, wind=E]

Epoch 30/50
  Train - Total: 0.934508, Surface: 0.489452, Upper Air: 0.445057
Epoch 30/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.106513, Surface: 0.609320, Upper Air: 0.497193
Epoch 31/50 [Train]: 100%|██████████| 26/26 [01:32<00:00,  3.57s/it, loss=0.7565, surf=0.3714, upper=0.3851, wind=E]

Epoch 31/50
  Train - Total: 0.946677, Surface: 0.500661, Upper Air: 0.446015
Epoch 31/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.92s/it]
  Valid - Total: 1.089064, Surface: 0.596940, Upper Air: 0.492123
Epoch 32/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.39s/it, loss=1.1652, surf=0.6556, upper=0.5096, wind=E]

Epoch 32/50
  Train - Total: 0.940146, Surface: 0.495094, Upper Air: 0.445052
Epoch 32/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.108550, Surface: 0.608602, Upper Air: 0.499948
Epoch 33/50 [Train]: 100%|██████████| 26/26 [01:25<00:00,  3.31s/it, loss=0.9206, surf=0.4194, upper=0.5011, wind=E]

Epoch 33/50
  Train - Total: 0.941377, Surface: 0.493486, Upper Air: 0.447891
Epoch 33/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.093480, Surface: 0.595948, Upper Air: 0.497532
Epoch 34/50 [Train]: 100%|██████████| 26/26 [01:29<00:00,  3.45s/it, loss=0.9881, surf=0.4337, upper=0.5544, wind=E]

Epoch 34/50
  Train - Total: 0.936579, Surface: 0.492317, Upper Air: 0.444262
Epoch 34/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.097869, Surface: 0.601837, Upper Air: 0.496032
Epoch 35/50 [Train]: 100%|██████████| 26/26 [01:27<00:00,  3.36s/it, loss=0.8543, surf=0.4723, upper=0.3820, wind=E]

Epoch 35/50
  Train - Total: 0.918016, Surface: 0.477906, Upper Air: 0.440109
Epoch 35/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.90s/it]
  Valid - Total: 1.115277, Surface: 0.624656, Upper Air: 0.490622
Epoch 36/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.39s/it, loss=0.9293, surf=0.4358, upper=0.4935, wind=E]

Epoch 36/50
  Train - Total: 0.918636, Surface: 0.478464, Upper Air: 0.440172
Epoch 36/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.097249, Surface: 0.604009, Upper Air: 0.493240
Epoch 37/50 [Train]: 100%|██████████| 26/26 [01:27<00:00,  3.35s/it, loss=0.9886, surf=0.4948, upper=0.4938, wind=E]

Epoch 37/50
  Train - Total: 0.917505, Surface: 0.474927, Upper Air: 0.442578
Epoch 37/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.112455, Surface: 0.608313, Upper Air: 0.504142
Epoch 38/50 [Train]: 100%|██████████| 26/26 [01:30<00:00,  3.50s/it, loss=0.9819, surf=0.5203, upper=0.4616, wind=E]

Epoch 38/50
  Train - Total: 0.916498, Surface: 0.475632, Upper Air: 0.440866
Epoch 38/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.01s/it]
  Valid - Total: 1.108451, Surface: 0.609101, Upper Air: 0.499349
Epoch 39/50 [Train]: 100%|██████████| 26/26 [01:31<00:00,  3.52s/it, loss=0.8398, surf=0.4596, upper=0.3803, wind=E]

Epoch 39/50
  Train - Total: 0.911188, Surface: 0.472955, Upper Air: 0.438233
Epoch 39/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.97s/it]
  Valid - Total: 1.089641, Surface: 0.595372, Upper Air: 0.494269
Epoch 40/50 [Train]: 100%|██████████| 26/26 [01:29<00:00,  3.45s/it, loss=0.8205, surf=0.4529, upper=0.3676, wind=E]

Epoch 40/50
  Train - Total: 0.916652, Surface: 0.479383, Upper Air: 0.437269
Epoch 40/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.093105, Surface: 0.597456, Upper Air: 0.495649
Epoch 41/50 [Train]: 100%|██████████| 26/26 [01:28<00:00,  3.41s/it, loss=0.9247, surf=0.4885, upper=0.4362, wind=E]

Epoch 41/50
  Train - Total: 0.914516, Surface: 0.473771, Upper Air: 0.440745
Epoch 41/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.94s/it]
  Valid - Total: 1.086511, Surface: 0.589822, Upper Air: 0.496689
Epoch 42/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.32s/it, loss=1.2219, surf=0.7589, upper=0.4630, wind=E]

Epoch 42/50
  Train - Total: 0.903600, Surface: 0.462866, Upper Air: 0.440734
Epoch 42/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.94s/it]
  Valid - Total: 1.120593, Surface: 0.618140, Upper Air: 0.502453
Epoch 43/50 [Train]: 100%|██████████| 26/26 [01:29<00:00,  3.43s/it, loss=0.9238, surf=0.4311, upper=0.4927, wind=E]

Epoch 43/50
  Train - Total: 0.920579, Surface: 0.481541, Upper Air: 0.439039
Epoch 43/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.123957, Surface: 0.619013, Upper Air: 0.504943
Epoch 44/50 [Train]: 100%|██████████| 26/26 [01:30<00:00,  3.47s/it, loss=0.7353, surf=0.3523, upper=0.3829, wind=E]

Epoch 44/50
  Train - Total: 0.897977, Surface: 0.462532, Upper Air: 0.435445
Epoch 44/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.090874, Surface: 0.590961, Upper Air: 0.499913
Epoch 45/50 [Train]: 100%|██████████| 26/26 [01:33<00:00,  3.60s/it, loss=0.8494, surf=0.3905, upper=0.4589, wind=E]

Epoch 45/50
  Train - Total: 0.885160, Surface: 0.449348, Upper Air: 0.435813
Epoch 45/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.95s/it]
  Valid - Total: 1.108081, Surface: 0.611915, Upper Air: 0.496165
Epoch 46/50 [Train]: 100%|██████████| 26/26 [01:29<00:00,  3.44s/it, loss=0.9301, surf=0.5100, upper=0.4201, wind=E]

Epoch 46/50
  Train - Total: 0.892644, Surface: 0.456296, Upper Air: 0.436348
Epoch 46/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.02s/it]
  Valid - Total: 1.094957, Surface: 0.601070, Upper Air: 0.493887
Epoch 47/50 [Train]: 100%|██████████| 26/26 [01:32<00:00,  3.55s/it, loss=0.7868, surf=0.4059, upper=0.3809, wind=E]

Epoch 47/50
  Train - Total: 0.877269, Surface: 0.445367, Upper Air: 0.431902
Epoch 47/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:28<00:00,  2.89s/it]
  Valid - Total: 1.114437, Surface: 0.611470, Upper Air: 0.502967
Epoch 48/50 [Train]: 100%|██████████| 26/26 [01:26<00:00,  3.34s/it, loss=0.8525, surf=0.4668, upper=0.3857, wind=E]

Epoch 48/50
  Train - Total: 0.875661, Surface: 0.444581, Upper Air: 0.431080
Epoch 48/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.92s/it]
  Valid - Total: 1.129997, Surface: 0.627284, Upper Air: 0.502713
Epoch 49/50 [Train]: 100%|██████████| 26/26 [01:30<00:00,  3.48s/it, loss=1.1582, surf=0.6992, upper=0.4589, wind=E]

Epoch 49/50
  Train - Total: 0.882851, Surface: 0.451820, Upper Air: 0.431031
Epoch 49/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.96s/it]
  Valid - Total: 1.095041, Surface: 0.599672, Upper Air: 0.495369
Epoch 50/50 [Train]: 100%|██████████| 26/26 [01:34<00:00,  3.64s/it, loss=0.8616, surf=0.3899, upper=0.4717, wind=E]

Epoch 50/50
  Train - Total: 0.873034, Surface: 0.440056, Upper Air: 0.432977
Epoch 50/50 [Valid]: 100%|██████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.93s/it]
  Valid - Total: 1.102722, Surface: 0.606161, Upper Air: 0.496562
  Saved checkpoint: checkpoints_v2_3/model_v2_3_epoch50.pth
Training completed!
(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# nvidia-smi
Sat Jan 10 18:38:31 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.05              Driver Version: 560.35.05      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A800 80GB PCIe          On  |   00000000:18:00.0 Off |                    0 |
| N/A   46C    P0             84W /  300W |   14263MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A    107739      C   ...al/miniconda3/envs/torch/bin/python          0MiB |
+-----------------------------------------------------------------------------------------+
(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# ^C
(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# python train_v2_4.py
Using device: cuda
Loading data...
Surface data shape: (52, 26, 721, 1440)
Upper air data shape: (52, 10, 5, 721, 1440)
Loading normalization parameters...
Surface mean shape: torch.Size([1, 26, 1, 721, 1440])
Upper mean shape: torch.Size([1, 10, 5, 1, 721, 1440])
Dataset from index 0 to 28, sample count: 26
Dataset from index 28 to 40, sample count: 10
Total training samples: 26
Total validation samples: 10
Mixed precision training: True
No checkpoint found. Starting fresh training.
======================================================================
Training V2.4 with Wind-Aware Per-Window Shift + Matching Attention Mask
======================================================================
Window size: (2, 6, 12)
Wind shift scale: 2
Wind speed threshold: 0.5 m/s
Top-K wind directions: 3
Embed dim: 192
======================================================================

Epoch 1/50 [Train]:   0%|                                                                                                                                                                                               | 0/26 [00:00<?, ?it/s]/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

  [Wind Direction Info]:
  wind_direction_id shape: torch.Size([1, 31, 30])
  Unique directions: ['None', 'N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW']
  Sample (5x5 windows):
    ['E', 'E', 'SE', 'SE', 'SE']
    ['E', 'E', 'SE', 'SE', 'SE']
    ['NE', 'SE', 'SE', 'S', 'S']
    ['NW', 'SW', 'S', 'S', 'S']
    ['N', 'SE', 'S', 'S', 'S']

Epoch 1/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:45<00:00,  4.07s/it, loss=1.5663, surf=0.9055, upper=0.6608, wind=E]

Epoch 1/50
  Train - Total: 1.909973, Surface: 1.187090, Upper Air: 0.722883
Epoch 1/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.493803, Surface: 0.889516, Upper Air: 0.604287
Epoch 2/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:41<00:00,  3.89s/it, loss=1.6939, surf=1.1647, upper=0.5293, wind=E]

Epoch 2/50
  Train - Total: 1.368060, Surface: 0.839655, Upper Air: 0.528406
Epoch 2/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.08s/it]
  Valid - Total: 1.383748, Surface: 0.825383, Upper Air: 0.558365
Epoch 3/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:38<00:00,  3.78s/it, loss=1.3314, surf=0.7943, upper=0.5371, wind=E]

Epoch 3/50
  Train - Total: 1.282031, Surface: 0.780582, Upper Air: 0.501449
Epoch 3/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.01s/it]
  Valid - Total: 1.288515, Surface: 0.752097, Upper Air: 0.536418
Epoch 4/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:42<00:00,  3.93s/it, loss=1.1281, surf=0.6140, upper=0.5141, wind=E]

Epoch 4/50
  Train - Total: 1.188770, Surface: 0.702438, Upper Air: 0.486332
Epoch 4/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.07s/it]
  Valid - Total: 1.224993, Surface: 0.699769, Upper Air: 0.525224
Epoch 5/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:41<00:00,  3.90s/it, loss=1.1695, surf=0.7146, upper=0.4549, wind=E]

Epoch 5/50
  Train - Total: 1.161630, Surface: 0.676888, Upper Air: 0.484741
Epoch 5/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.07s/it]
  Valid - Total: 1.190260, Surface: 0.670641, Upper Air: 0.519619
Epoch 6/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.85s/it, loss=1.0432, surf=0.5348, upper=0.5084, wind=E]

Epoch 6/50
  Train - Total: 1.110444, Surface: 0.632770, Upper Air: 0.477675
Epoch 6/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.00s/it]
  Valid - Total: 1.170438, Surface: 0.659579, Upper Air: 0.510859
Epoch 7/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.81s/it, loss=0.8991, surf=0.4651, upper=0.4340, wind=E]

Epoch 7/50
  Train - Total: 1.096559, Surface: 0.623465, Upper Air: 0.473094
Epoch 7/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  3.17s/it]
  Valid - Total: 1.179872, Surface: 0.667641, Upper Air: 0.512231
Epoch 8/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:41<00:00,  3.90s/it, loss=1.1834, surf=0.6716, upper=0.5118, wind=E]

Epoch 8/50
  Train - Total: 1.079214, Surface: 0.609844, Upper Air: 0.469369
Epoch 8/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.09s/it]
  Valid - Total: 1.176408, Surface: 0.671999, Upper Air: 0.504409
Epoch 9/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.84s/it, loss=1.0517, surf=0.6258, upper=0.4259, wind=E]

Epoch 9/50
  Train - Total: 1.063306, Surface: 0.598571, Upper Air: 0.464736
Epoch 9/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.09s/it]
  Valid - Total: 1.146287, Surface: 0.635522, Upper Air: 0.510765
Epoch 10/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.72s/it, loss=1.2948, surf=0.7407, upper=0.5541, wind=E]

Epoch 10/50
  Train - Total: 1.045247, Surface: 0.583126, Upper Air: 0.462121
Epoch 10/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.150811, Surface: 0.645890, Upper Air: 0.504921
Epoch 11/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:38<00:00,  3.80s/it, loss=1.0195, surf=0.6073, upper=0.4122, wind=E]

Epoch 11/50
  Train - Total: 1.040133, Surface: 0.579810, Upper Air: 0.460323
Epoch 11/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  3.14s/it]
  Valid - Total: 1.132100, Surface: 0.631307, Upper Air: 0.500793
Epoch 12/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.71s/it, loss=1.0172, surf=0.5709, upper=0.4463, wind=E]

Epoch 12/50
  Train - Total: 1.029192, Surface: 0.568141, Upper Air: 0.461051
Epoch 12/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.07s/it]
  Valid - Total: 1.114316, Surface: 0.613107, Upper Air: 0.501209
Epoch 13/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.87s/it, loss=1.1320, surf=0.6886, upper=0.4435, wind=E]

Epoch 13/50
  Train - Total: 1.010416, Surface: 0.554244, Upper Air: 0.456172
Epoch 13/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.09s/it]
  Valid - Total: 1.120466, Surface: 0.618207, Upper Air: 0.502259
Epoch 14/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.83s/it, loss=1.0765, surf=0.6492, upper=0.4273, wind=E]

Epoch 14/50
  Train - Total: 1.010352, Surface: 0.553973, Upper Air: 0.456379
Epoch 14/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.05s/it]
  Valid - Total: 1.127891, Surface: 0.630489, Upper Air: 0.497401
Epoch 15/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.81s/it, loss=0.8609, surf=0.4484, upper=0.4124, wind=E]

Epoch 15/50
  Train - Total: 0.997452, Surface: 0.543791, Upper Air: 0.453662
Epoch 15/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.112835, Surface: 0.619881, Upper Air: 0.492955
Epoch 16/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.82s/it, loss=1.0841, surf=0.5792, upper=0.5049, wind=E]

Epoch 16/50
  Train - Total: 0.994862, Surface: 0.540689, Upper Air: 0.454173
Epoch 16/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.110835, Surface: 0.609213, Upper Air: 0.501621
Epoch 17/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:42<00:00,  3.93s/it, loss=0.8322, surf=0.4270, upper=0.4052, wind=E]

Epoch 17/50
  Train - Total: 0.979879, Surface: 0.527123, Upper Air: 0.452756
Epoch 17/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  2.99s/it]
  Valid - Total: 1.093777, Surface: 0.599471, Upper Air: 0.494305
Epoch 18/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.70s/it, loss=0.9072, surf=0.5053, upper=0.4019, wind=E]

Epoch 18/50
  Train - Total: 0.969604, Surface: 0.520270, Upper Air: 0.449333
Epoch 18/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.126826, Surface: 0.630850, Upper Air: 0.495977
Epoch 19/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.63s/it, loss=1.0145, surf=0.5893, upper=0.4252, wind=E]

Epoch 19/50
  Train - Total: 0.982691, Surface: 0.533200, Upper Air: 0.449490
Epoch 19/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.127171, Surface: 0.634073, Upper Air: 0.493098
Epoch 20/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.86s/it, loss=0.8111, surf=0.4132, upper=0.3979, wind=E]

Epoch 20/50
  Train - Total: 0.974182, Surface: 0.523538, Upper Air: 0.450644
Epoch 20/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.125589, Surface: 0.621300, Upper Air: 0.504289
Epoch 21/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.85s/it, loss=0.8933, surf=0.5001, upper=0.3931, wind=E]

Epoch 21/50
  Train - Total: 0.956372, Surface: 0.510537, Upper Air: 0.445835
Epoch 21/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.00s/it]
  Valid - Total: 1.109156, Surface: 0.610150, Upper Air: 0.499005
Epoch 22/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.82s/it, loss=1.0431, surf=0.6095, upper=0.4336, wind=E]

Epoch 22/50
  Train - Total: 0.961565, Surface: 0.513069, Upper Air: 0.448497
Epoch 22/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.105075, Surface: 0.613163, Upper Air: 0.491912
Epoch 23/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.62s/it, loss=0.9709, surf=0.4808, upper=0.4900, wind=E]

Epoch 23/50
  Train - Total: 0.952364, Surface: 0.508810, Upper Air: 0.443554
Epoch 23/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.099582, Surface: 0.608023, Upper Air: 0.491559
Epoch 24/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:35<00:00,  3.66s/it, loss=1.0266, surf=0.5288, upper=0.4978, wind=E]

Epoch 24/50
  Train - Total: 0.943137, Surface: 0.499528, Upper Air: 0.443608
Epoch 24/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.05s/it]
  Valid - Total: 1.103207, Surface: 0.600303, Upper Air: 0.502905
Epoch 25/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.82s/it, loss=0.8113, surf=0.4478, upper=0.3635, wind=E]

Epoch 25/50
  Train - Total: 0.940200, Surface: 0.497406, Upper Air: 0.442794
Epoch 25/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.01s/it]
  Valid - Total: 1.099584, Surface: 0.606146, Upper Air: 0.493438
  Saved checkpoint: checkpoints_v2_4/model_v2_4_epoch25.pth
Epoch 26/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.65s/it, loss=0.9270, surf=0.4270, upper=0.4999, wind=E]

Epoch 26/50
  Train - Total: 0.946673, Surface: 0.503611, Upper Air: 0.443062
Epoch 26/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.112342, Surface: 0.610523, Upper Air: 0.501819
Epoch 27/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.87s/it, loss=0.7692, surf=0.3913, upper=0.3779, wind=E]

Epoch 27/50
  Train - Total: 0.940029, Surface: 0.495262, Upper Air: 0.444766
Epoch 27/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.01s/it]
  Valid - Total: 1.098310, Surface: 0.605565, Upper Air: 0.492744
Epoch 28/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.81s/it, loss=0.9124, surf=0.5185, upper=0.3939, wind=E]

Epoch 28/50
  Train - Total: 0.930565, Surface: 0.489912, Upper Air: 0.440653
Epoch 28/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  3.00s/it]
  Valid - Total: 1.099981, Surface: 0.603268, Upper Air: 0.496714
Epoch 29/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:42<00:00,  3.95s/it, loss=0.9060, surf=0.4168, upper=0.4892, wind=E]

Epoch 29/50
  Train - Total: 0.920530, Surface: 0.482951, Upper Air: 0.437579
Epoch 29/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.06s/it]
  Valid - Total: 1.098222, Surface: 0.594250, Upper Air: 0.503971
Epoch 30/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:44<00:00,  4.01s/it, loss=0.9465, surf=0.5285, upper=0.4180, wind=E]

Epoch 30/50
  Train - Total: 0.926742, Surface: 0.489674, Upper Air: 0.437068
Epoch 30/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.096606, Surface: 0.595492, Upper Air: 0.501114
Epoch 31/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.73s/it, loss=1.1312, surf=0.6331, upper=0.4981, wind=E]

Epoch 31/50
  Train - Total: 0.935363, Surface: 0.497287, Upper Air: 0.438076
Epoch 31/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.02s/it]
  Valid - Total: 1.112718, Surface: 0.620173, Upper Air: 0.492545
Epoch 32/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.71s/it, loss=1.0235, surf=0.5947, upper=0.4288, wind=E]

Epoch 32/50
  Train - Total: 0.917395, Surface: 0.482512, Upper Air: 0.434883
Epoch 32/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  3.00s/it]
  Valid - Total: 1.114195, Surface: 0.622395, Upper Air: 0.491800
Epoch 33/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.62s/it, loss=0.7946, surf=0.3944, upper=0.4001, wind=E]

Epoch 33/50
  Train - Total: 0.915971, Surface: 0.477484, Upper Air: 0.438488
Epoch 33/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.05s/it]
  Valid - Total: 1.108233, Surface: 0.609888, Upper Air: 0.498345
Epoch 34/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.62s/it, loss=0.9284, surf=0.4491, upper=0.4794, wind=E]

Epoch 34/50
  Train - Total: 0.904974, Surface: 0.469277, Upper Air: 0.435697
Epoch 34/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.06s/it]
  Valid - Total: 1.097168, Surface: 0.602629, Upper Air: 0.494539
Epoch 35/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:41<00:00,  3.89s/it, loss=0.7507, surf=0.3796, upper=0.3711, wind=E]

Epoch 35/50
  Train - Total: 0.898561, Surface: 0.468840, Upper Air: 0.429720
Epoch 35/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.06s/it]
  Valid - Total: 1.099346, Surface: 0.606197, Upper Air: 0.493149
Epoch 36/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.71s/it, loss=0.9628, surf=0.4859, upper=0.4768, wind=E]

Epoch 36/50
  Train - Total: 0.897472, Surface: 0.467486, Upper Air: 0.429985
Epoch 36/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.115908, Surface: 0.620598, Upper Air: 0.495310
Epoch 37/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:33<00:00,  3.58s/it, loss=1.2013, surf=0.7527, upper=0.4487, wind=E]

Epoch 37/50
  Train - Total: 0.887388, Surface: 0.457481, Upper Air: 0.429907
Epoch 37/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.129898, Surface: 0.621256, Upper Air: 0.508642
Epoch 38/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:38<00:00,  3.81s/it, loss=0.9036, surf=0.4897, upper=0.4139, wind=E]

Epoch 38/50
  Train - Total: 0.885189, Surface: 0.456502, Upper Air: 0.428687
Epoch 38/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.04s/it]
  Valid - Total: 1.103820, Surface: 0.607676, Upper Air: 0.496144
Epoch 39/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:37<00:00,  3.74s/it, loss=0.9908, surf=0.4281, upper=0.5627, wind=E]

Epoch 39/50
  Train - Total: 0.867647, Surface: 0.441228, Upper Air: 0.426419
Epoch 39/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.09s/it]
  Valid - Total: 1.082409, Surface: 0.588253, Upper Air: 0.494156
Epoch 40/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:37<00:00,  3.76s/it, loss=0.9534, surf=0.4805, upper=0.4729, wind=E]

Epoch 40/50
  Train - Total: 0.879038, Surface: 0.453684, Upper Air: 0.425354
Epoch 40/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.07s/it]
  Valid - Total: 1.130998, Surface: 0.627765, Upper Air: 0.503233
Epoch 41/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.87s/it, loss=0.9014, surf=0.4924, upper=0.4089, wind=E]

Epoch 41/50
  Train - Total: 0.878984, Surface: 0.451397, Upper Air: 0.427586
Epoch 41/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it]
  Valid - Total: 1.113415, Surface: 0.614606, Upper Air: 0.498808
Epoch 42/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:37<00:00,  3.75s/it, loss=0.9599, surf=0.4715, upper=0.4883, wind=E]

Epoch 42/50
  Train - Total: 0.862602, Surface: 0.438175, Upper Air: 0.424427
Epoch 42/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.03s/it]
  Valid - Total: 1.142159, Surface: 0.629428, Upper Air: 0.512732
Epoch 43/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:44<00:00,  4.01s/it, loss=0.8891, surf=0.4814, upper=0.4077, wind=E]

Epoch 43/50
  Train - Total: 0.871720, Surface: 0.440320, Upper Air: 0.431400
Epoch 43/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  3.15s/it]
  Valid - Total: 1.123915, Surface: 0.622979, Upper Air: 0.500936
Epoch 44/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:35<00:00,  3.68s/it, loss=0.9039, surf=0.4348, upper=0.4691, wind=E]

Epoch 44/50
  Train - Total: 0.864435, Surface: 0.441358, Upper Air: 0.423078
Epoch 44/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.08s/it]
  Valid - Total: 1.168498, Surface: 0.652973, Upper Air: 0.515525
Epoch 45/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:39<00:00,  3.81s/it, loss=0.7456, surf=0.3775, upper=0.3682, wind=E]

Epoch 45/50
  Train - Total: 0.853800, Surface: 0.432926, Upper Air: 0.420874
Epoch 45/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.05s/it]
  Valid - Total: 1.118551, Surface: 0.608948, Upper Air: 0.509603
Epoch 46/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:36<00:00,  3.72s/it, loss=0.9066, surf=0.4422, upper=0.4643, wind=E]

Epoch 46/50
  Train - Total: 0.840556, Surface: 0.420231, Upper Air: 0.420325
Epoch 46/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.00s/it]
  Valid - Total: 1.143548, Surface: 0.632621, Upper Air: 0.510927
Epoch 47/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.65s/it, loss=0.8436, surf=0.4458, upper=0.3979, wind=E]

Epoch 47/50
  Train - Total: 0.829262, Surface: 0.414926, Upper Air: 0.414336
Epoch 47/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.10s/it]
  Valid - Total: 1.103011, Surface: 0.602403, Upper Air: 0.500607
Epoch 48/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.87s/it, loss=0.8030, surf=0.3654, upper=0.4376, wind=E]

Epoch 48/50
  Train - Total: 0.829836, Surface: 0.416316, Upper Air: 0.413519
Epoch 48/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  3.15s/it]
  Valid - Total: 1.160209, Surface: 0.633341, Upper Air: 0.526867
Epoch 49/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:40<00:00,  3.85s/it, loss=0.6960, surf=0.3368, upper=0.3592, wind=E]

Epoch 49/50
  Train - Total: 0.821807, Surface: 0.406432, Upper Air: 0.415375
Epoch 49/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:31<00:00,  3.19s/it]
  Valid - Total: 1.102976, Surface: 0.599621, Upper Air: 0.503355
Epoch 50/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:34<00:00,  3.64s/it, loss=0.7874, surf=0.3484, upper=0.4390, wind=E]

Epoch 50/50
  Train - Total: 0.817294, Surface: 0.405199, Upper Air: 0.412095
Epoch 50/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:30<00:00,  3.05s/it]
  Valid - Total: 1.136538, Surface: 0.618192, Upper Air: 0.518346
  Saved checkpoint: checkpoints_v2_4/model_v2_4_epoch50.pth
Training completed!


(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# python train_v2_5.py
Using device: cuda
Loading data...
Surface data shape: (52, 26, 721, 1440)
Upper air data shape: (52, 10, 5, 721, 1440)
Loading normalization parameters...
Surface mean shape: torch.Size([1, 26, 1, 721, 1440])
Upper mean shape: torch.Size([1, 10, 5, 1, 721, 1440])
Dataset from index 0 to 28, sample count: 26
Dataset from index 28 to 40, sample count: 10
Total training samples: 26
Total validation samples: 10
Mixed precision training: True
No checkpoint found. Starting fresh training.
======================================================================
Training V2.5 with Wind-Aware Per-Window Shift + Matching Attention Mask
======================================================================
Window size: (2, 6, 12)
Wind shift scale: 2
Wind speed threshold: 0.5 m/s
Top-K wind directions (by layer): (2, 1, 1, 1)
Embed dim: 192
Num heads: (12, 24, 24, 12)
Depths: (4, 8, 8, 4)
Drop path max: 0.3
======================================================================
Epoch 1/50 [Train]:   0%|                                                                                                                                                                                                                                                               | 0/26 [00:00<?, ?it/s]/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)

  [Wind Direction Info]:
  wind_direction_id shape: torch.Size([1, 31, 30])
  Unique directions: ['None', 'N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW']
  Sample (5x5 windows):
    ['S', 'S', 'S', 'S', 'SW']
    ['SE', 'SE', 'SE', 'SE', 'SE']
    ['E', 'E', 'SE', 'SE', 'SE']
    ['E', 'E', 'SE', 'E', 'E']
    ['E', 'E', 'E', 'E', 'E']

Epoch 1/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:22<00:00,  5.47s/it, loss=1.3530, surf=0.7546, upper=0.5984, wind=E]

Epoch 1/50
  Train - Total: 1.901680, Surface: 1.074485, Upper Air: 0.827195
Epoch 1/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.38s/it]
  Valid - Total: 1.475148, Surface: 0.804176, Upper Air: 0.670972
Epoch 2/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.24s/it, loss=1.4281, surf=0.8278, upper=0.6002, wind=E]

Epoch 2/50
  Train - Total: 1.368406, Surface: 0.792494, Upper Air: 0.575911
Epoch 2/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:32<00:00,  3.29s/it]
  Valid - Total: 1.359192, Surface: 0.761320, Upper Air: 0.597872
Epoch 3/50 [Train]:  23%|█████████████████████████████████████████████▉                                                                                                                                                         | 6/26 [00:55<01:55,  5.75s/it, loss=1.3996, surf=0.8086, upper=0.5911, wind=E]
Epoch 3/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=1.3093, surf=0.7496, upper=0.5597, wind=E]

Epoch 3/50
  Train - Total: 1.233988, Surface: 0.703080, Upper Air: 0.530908
Epoch 3/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.44s/it]
  Valid - Total: 1.248017, Surface: 0.686284, Upper Air: 0.561734
Epoch 4/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=1.0724, surf=0.5358, upper=0.5366, wind=E]

Epoch 4/50
  Train - Total: 1.175779, Surface: 0.663460, Upper Air: 0.512319
Epoch 4/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.226968, Surface: 0.678117, Upper Air: 0.548851
Epoch 5/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.26s/it, loss=1.0081, surf=0.5097, upper=0.4984, wind=E]

Epoch 5/50
  Train - Total: 1.142149, Surface: 0.643920, Upper Air: 0.498229
Epoch 5/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.39s/it]
  Valid - Total: 1.215402, Surface: 0.678313, Upper Air: 0.537088
Epoch 6/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.39s/it, loss=1.1476, surf=0.5425, upper=0.6051, wind=E]

Epoch 6/50
  Train - Total: 1.115702, Surface: 0.626863, Upper Air: 0.488839
Epoch 6/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.31s/it]
  Valid - Total: 1.212906, Surface: 0.681181, Upper Air: 0.531725
Epoch 7/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.15s/it, loss=1.2339, surf=0.7182, upper=0.5156, wind=E]

Epoch 7/50
  Train - Total: 1.092160, Surface: 0.608884, Upper Air: 0.483276
Epoch 7/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.41s/it]
  Valid - Total: 1.158432, Surface: 0.637199, Upper Air: 0.521233
Epoch 8/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:14<00:00,  5.16s/it, loss=1.2343, surf=0.6902, upper=0.5441, wind=E]

Epoch 8/50
  Train - Total: 1.061985, Surface: 0.581445, Upper Air: 0.480540
Epoch 8/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.31s/it]
  Valid - Total: 1.143640, Surface: 0.625992, Upper Air: 0.517648
Epoch 9/50 [Train]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=1.0624, surf=0.5518, upper=0.5106, wind=E]

Epoch 9/50
  Train - Total: 1.055731, Surface: 0.578825, Upper Air: 0.476906
Epoch 9/50 [Valid]: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.179525, Surface: 0.663413, Upper Air: 0.516112
Epoch 10/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.30s/it, loss=1.0328, surf=0.5339, upper=0.4989, wind=E]

Epoch 10/50
  Train - Total: 1.045998, Surface: 0.571958, Upper Air: 0.474040
Epoch 10/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.38s/it]
  Valid - Total: 1.150780, Surface: 0.640606, Upper Air: 0.510174
Epoch 11/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.28s/it, loss=0.9691, surf=0.4659, upper=0.5032, wind=E]

Epoch 11/50
  Train - Total: 1.036164, Surface: 0.565599, Upper Air: 0.470566
Epoch 11/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.40s/it]
  Valid - Total: 1.136006, Surface: 0.623405, Upper Air: 0.512601
Epoch 12/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.26s/it, loss=1.1256, surf=0.6750, upper=0.4506, wind=E]

Epoch 12/50
  Train - Total: 1.015294, Surface: 0.547055, Upper Air: 0.468239
Epoch 12/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:32<00:00,  3.27s/it]
  Valid - Total: 1.150403, Surface: 0.638573, Upper Air: 0.511830
Epoch 13/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.30s/it, loss=1.1019, surf=0.6092, upper=0.4927, wind=E]

Epoch 13/50
  Train - Total: 1.007167, Surface: 0.542709, Upper Air: 0.464458
Epoch 13/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.34s/it]
  Valid - Total: 1.110385, Surface: 0.607337, Upper Air: 0.503049
Epoch 14/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.44s/it, loss=1.0430, surf=0.4697, upper=0.5733, wind=E]

Epoch 14/50
  Train - Total: 1.006476, Surface: 0.541748, Upper Air: 0.464727
Epoch 14/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.112163, Surface: 0.607414, Upper Air: 0.504749
Epoch 15/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.44s/it, loss=0.9170, surf=0.4306, upper=0.4863, wind=E]

Epoch 15/50
  Train - Total: 0.995604, Surface: 0.533292, Upper Air: 0.462312
Epoch 15/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.111851, Surface: 0.609647, Upper Air: 0.502204
Epoch 16/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:24<00:00,  5.54s/it, loss=1.0548, surf=0.5422, upper=0.5126, wind=E]

Epoch 16/50
  Train - Total: 0.980765, Surface: 0.522587, Upper Air: 0.458178
Epoch 16/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.31s/it]
  Valid - Total: 1.085876, Surface: 0.585163, Upper Air: 0.500713
Epoch 17/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:12<00:00,  5.11s/it, loss=0.8875, surf=0.4885, upper=0.3990, wind=E]

Epoch 17/50
  Train - Total: 0.982833, Surface: 0.524298, Upper Air: 0.458535
Epoch 17/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.101766, Surface: 0.601918, Upper Air: 0.499849
Epoch 18/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.25s/it, loss=0.7973, surf=0.4068, upper=0.3905, wind=E]

Epoch 18/50
  Train - Total: 0.979482, Surface: 0.521834, Upper Air: 0.457648
Epoch 18/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.104115, Surface: 0.606792, Upper Air: 0.497323
Epoch 19/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:19<00:00,  5.35s/it, loss=0.8843, surf=0.4172, upper=0.4671, wind=E]

Epoch 19/50
  Train - Total: 0.974847, Surface: 0.519654, Upper Air: 0.455193
Epoch 19/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.40s/it]
  Valid - Total: 1.093565, Surface: 0.588023, Upper Air: 0.505542
Epoch 20/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=0.8480, surf=0.4435, upper=0.4045, wind=E]

Epoch 20/50
  Train - Total: 0.968990, Surface: 0.513015, Upper Air: 0.455975
Epoch 20/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.119681, Surface: 0.622204, Upper Air: 0.497477
Epoch 21/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.25s/it, loss=0.9695, surf=0.5479, upper=0.4217, wind=E]

Epoch 21/50
  Train - Total: 0.973275, Surface: 0.518390, Upper Air: 0.454885
Epoch 21/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:32<00:00,  3.29s/it]
  Valid - Total: 1.101539, Surface: 0.607647, Upper Air: 0.493892
Epoch 22/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.51s/it, loss=1.0431, surf=0.5432, upper=0.4999, wind=E]

Epoch 22/50
  Train - Total: 0.966344, Surface: 0.513557, Upper Air: 0.452787
Epoch 22/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.083644, Surface: 0.589163, Upper Air: 0.494481
Epoch 23/50 [Train]: 100%|█| 26/26 [02:22<00:00,  5.47s/it, loss=0.8157, sur

Epoch 23/50
  Train - Total: 0.948557, Surface: 0.496707, Upper Air: 0.451850
Epoch 23/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.36s/it]
  Valid - Total: 1.092397, Surface: 0.598491, Upper Air: 0.493905
Epoch 24/50 [Train]: 100%|█| 26/26 [02:22<00:00,  5.48s/it, loss=0.9503, sur

Epoch 24/50
  Train - Total: 0.951951, Surface: 0.498080, Upper Air: 0.453872
Epoch 24/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.103222, Surface: 0.607456, Upper Air: 0.495766
Epoch 25/50 [Train]: 100%|█| 26/26 [02:20<00:00,  5.39s/it, loss=0.9371, sur

Epoch 25/50
  Train - Total: 0.950598, Surface: 0.499328, Upper Air: 0.451270
Epoch 25/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.075768, Surface: 0.584304, Upper Air: 0.491464
  Saved checkpoint: checkpoints_v2_5/model_v2_5_epoch25.pth
Epoch 26/50 [Train]: 100%|█| 26/26 [02:20<00:00,  5.41s/it, loss=1.1387, sur

Epoch 26/50
  Train - Total: 0.944074, Surface: 0.493948, Upper Air: 0.450126
Epoch 26/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.097530, Surface: 0.599331, Upper Air: 0.498199
Epoch 27/50 [Train]: 100%|█| 26/26 [02:17<00:00,  5.28s/it, loss=0.8860, sur

Epoch 27/50
  Train - Total: 0.944321, Surface: 0.494737, Upper Air: 0.449583
Epoch 27/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.31s/it]
  Valid - Total: 1.102218, Surface: 0.610418, Upper Air: 0.491800
Epoch 28/50 [Train]: 100%|█| 26/26 [02:14<00:00,  5.16s/it, loss=1.1686, sur

Epoch 28/50
  Train - Total: 0.943971, Surface: 0.493556, Upper Air: 0.450415
Epoch 28/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.35s/it]
  Valid - Total: 1.070093, Surface: 0.576567, Upper Air: 0.493526
Epoch 29/50 [Train]: 100%|█| 26/26 [02:18<00:00,  5.33s/it, loss=0.9638, sur

Epoch 29/50
  Train - Total: 0.935322, Surface: 0.488503, Upper Air: 0.446819
Epoch 29/50 [Valid]: 100%|██████████████████| 10/10 [00:34<00:00,  3.41s/it]
  Valid - Total: 1.077388, Surface: 0.584814, Upper Air: 0.492574
Epoch 30/50 [Train]: 100%|█| 26/26 [02:17<00:00,  5.29s/it, loss=0.9197, sur

Epoch 30/50
  Train - Total: 0.923357, Surface: 0.476899, Upper Air: 0.446458
Epoch 30/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.064865, Surface: 0.573355, Upper Air: 0.491510
Epoch 31/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.12s/it, loss=0.9960, sur

Epoch 31/50
  Train - Total: 0.931748, Surface: 0.487914, Upper Air: 0.443833
Epoch 31/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.114352, Surface: 0.619135, Upper Air: 0.495217
Epoch 32/50 [Train]: 100%|█| 26/26 [02:20<00:00,  5.42s/it, loss=0.9215, sur

Epoch 32/50
  Train - Total: 0.928382, Surface: 0.481727, Upper Air: 0.446655
Epoch 32/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.34s/it]
  Valid - Total: 1.074548, Surface: 0.582445, Upper Air: 0.492103
Epoch 33/50 [Train]: 100%|█| 26/26 [02:15<00:00,  5.23s/it, loss=0.9612, sur

Epoch 33/50
  Train - Total: 0.922376, Surface: 0.477941, Upper Air: 0.444435
Epoch 33/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.146458, Surface: 0.648267, Upper Air: 0.498190
Epoch 34/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.14s/it, loss=0.8685, sur

Epoch 34/50
  Train - Total: 0.922235, Surface: 0.478938, Upper Air: 0.443297
Epoch 34/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.38s/it]
  Valid - Total: 1.080522, Surface: 0.586633, Upper Air: 0.493890
Epoch 35/50 [Train]: 100%|█| 26/26 [02:12<00:00,  5.08s/it, loss=0.9419, sur

Epoch 35/50
  Train - Total: 0.914949, Surface: 0.473724, Upper Air: 0.441225
Epoch 35/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.31s/it]
  Valid - Total: 1.098342, Surface: 0.608388, Upper Air: 0.489954
Epoch 36/50 [Train]: 100%|█| 26/26 [02:17<00:00,  5.29s/it, loss=1.0256, sur

Epoch 36/50
  Train - Total: 0.920521, Surface: 0.479574, Upper Air: 0.440947
Epoch 36/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.068559, Surface: 0.575668, Upper Air: 0.492892
Epoch 37/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.12s/it, loss=0.8404, sur

Epoch 37/50
  Train - Total: 0.917340, Surface: 0.476981, Upper Air: 0.440359
Epoch 37/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.30s/it]
  Valid - Total: 1.085200, Surface: 0.593364, Upper Air: 0.491836
Epoch 38/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.13s/it, loss=0.9549, sur

Epoch 38/50
  Train - Total: 0.906203, Surface: 0.466164, Upper Air: 0.440039
Epoch 38/50 [Valid]: 100%|██████████████████| 10/10 [00:34<00:00,  3.42s/it]
  Valid - Total: 1.084453, Surface: 0.594413, Upper Air: 0.490040
Epoch 39/50 [Train]: 100%|█| 26/26 [02:20<00:00,  5.41s/it, loss=0.9567, sur

Epoch 39/50
  Train - Total: 0.902845, Surface: 0.465903, Upper Air: 0.436942
Epoch 39/50 [Valid]: 100%|██████████████████| 10/10 [00:34<00:00,  3.43s/it]
  Valid - Total: 1.111352, Surface: 0.615522, Upper Air: 0.495830
Epoch 40/50 [Train]: 100%|█| 26/26 [02:15<00:00,  5.20s/it, loss=1.1393, sur

Epoch 40/50
  Train - Total: 0.902135, Surface: 0.462517, Upper Air: 0.439618
Epoch 40/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.080806, Surface: 0.589123, Upper Air: 0.491684
Epoch 41/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.12s/it, loss=0.7346, sur

Epoch 41/50
  Train - Total: 0.896881, Surface: 0.459121, Upper Air: 0.437759
Epoch 41/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.076786, Surface: 0.582321, Upper Air: 0.494465
Epoch 42/50 [Train]: 100%|█| 26/26 [02:15<00:00,  5.20s/it, loss=0.7881, sur

Epoch 42/50
  Train - Total: 0.899406, Surface: 0.461330, Upper Air: 0.438076
Epoch 42/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.33s/it]
  Valid - Total: 1.078537, Surface: 0.588081, Upper Air: 0.490456
Epoch 43/50 [Train]: 100%|█| 26/26 [02:14<00:00,  5.18s/it, loss=0.9143, sur

Epoch 43/50
  Train - Total: 0.887240, Surface: 0.450217, Upper Air: 0.437023
Epoch 43/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.34s/it]
  Valid - Total: 1.096007, Surface: 0.602927, Upper Air: 0.493081
Epoch 44/50 [Train]: 100%|█| 26/26 [02:18<00:00,  5.32s/it, loss=0.8014, sur

Epoch 44/50
  Train - Total: 0.882369, Surface: 0.446488, Upper Air: 0.435880
Epoch 44/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.35s/it]
  Valid - Total: 1.102596, Surface: 0.613183, Upper Air: 0.489412
Epoch 45/50 [Train]: 100%|█| 26/26 [02:14<00:00,  5.19s/it, loss=0.8112, sur

Epoch 45/50
  Train - Total: 0.873722, Surface: 0.439526, Upper Air: 0.434195
Epoch 45/50 [Valid]: 100%|██████████████████| 10/10 [00:32<00:00,  3.29s/it]
  Valid - Total: 1.104269, Surface: 0.610303, Upper Air: 0.493965
Epoch 46/50 [Train]: 100%|█| 26/26 [02:21<00:00,  5.44s/it, loss=0.8543, sur

Epoch 46/50
  Train - Total: 0.883083, Surface: 0.448863, Upper Air: 0.434220
Epoch 46/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.36s/it]
  Valid - Total: 1.112426, Surface: 0.621000, Upper Air: 0.491426
Epoch 47/50 [Train]: 100%|█| 26/26 [02:13<00:00,  5.14s/it, loss=0.9354, sur

Epoch 47/50
  Train - Total: 0.871822, Surface: 0.439595, Upper Air: 0.432227
Epoch 47/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.30s/it]
  Valid - Total: 1.108222, Surface: 0.616077, Upper Air: 0.492146
Epoch 48/50 [Train]: 100%|█| 26/26 [02:19<00:00,  5.37s/it, loss=0.8335, sur

Epoch 48/50
  Train - Total: 0.864222, Surface: 0.433754, Upper Air: 0.430468
Epoch 48/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.32s/it]
  Valid - Total: 1.124332, Surface: 0.628326, Upper Air: 0.496006
Epoch 49/50 [Train]: 100%|█| 26/26 [02:12<00:00,  5.11s/it, loss=0.8017, sur

Epoch 49/50
  Train - Total: 0.875163, Surface: 0.443197, Upper Air: 0.431967
Epoch 49/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.37s/it]
  Valid - Total: 1.101649, Surface: 0.603051, Upper Air: 0.498599
Epoch 50/50 [Train]: 100%|█| 26/26 [02:17<00:00,  5.29s/it, loss=0.8799, sur

Epoch 50/50
  Train - Total: 0.862832, Surface: 0.433486, Upper Air: 0.429347
Epoch 50/50 [Valid]: 100%|██████████████████| 10/10 [00:33<00:00,  3.35s/it]
  Valid - Total: 1.097943, Surface: 0.602649, Upper Air: 0.495294
  Saved checkpoint: checkpoints_v2_5/model_v2_5_epoch50.pth
Training completed!

# V 3.5
(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# python train_v3_5.py
Using device: cuda
Loading data...
Surface data shape: (52, 26, 721, 1440)
Upper air data shape: (52, 10, 5, 721, 1440)
Loading normalization parameters...
Surface mean shape: torch.Size([1, 26, 1, 721, 1440])
Upper mean shape: torch.Size([1, 10, 5, 1, 721, 1440])
Dataset from index 0 to 28, sample count: 26
Dataset from index 28 to 40, sample count: 10
Total training samples: 26
Total validation samples: 10
Mixed precision training: True
No checkpoint found. Starting fresh training.
======================================================================
Training V3.5 (V2.5 + Physical Constraints)
======================================================================
lambda_water=8, lambda_energy=2e-05, lambda_pressure=1e-08
lambda_temperature=0.03, lambda_momentum=10.0
lambda_focus=0.1, lambda_tweedie=12.0
======================================================================
Epoch 1/50 [Train]:   0%|                                                                                                                                                                                                                          | 0/26 [00:00<?, ?it/s]/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Loading constant masks to cuda:0...
Epoch 1/50 [Train]:   0%|                                                                                                                                                                                                                          | 0/26 [00:50<?, ?it/s]
Traceback (most recent call last):
  File "/home/CanglongPhysics/train_v3_5.py", line 714, in <module>
    loss_water = calculate_water_balance_loss(
  File "/home/CanglongPhysics/train_v3_5.py", line 120, in calculate_water_balance_loss
    return calculate_land_water_balance_loss(input_physical, output_physical)
  File "/home/CanglongPhysics/train_v3_5.py", line 94, in calculate_land_water_balance_loss
    masks = get_cached_masks(device)
  File "/home/CanglongPhysics/train_v3_5.py", line 36, in get_cached_masks
    land_mask = torch.load(land_path, map_location=device, weights_only=True).float()
  File "/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/serialization.py", line 1319, in load
    with _open_file_like(f, "rb") as opened_file:
  File "/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/serialization.py", line 659, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/serialization.py", line 640, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/CanglongPhysics/constant_masks/is_land.pt'
(torch) root@gz-ins-760323423171781:/home/CanglongPhysics# python train_v3_5.py
Using device: cuda
Loading data...
Surface data shape: (52, 26, 721, 1440)
Upper air data shape: (52, 10, 5, 721, 1440)
Loading normalization parameters...
Surface mean shape: torch.Size([1, 26, 1, 721, 1440])
Upper mean shape: torch.Size([1, 10, 5, 1, 721, 1440])
Dataset from index 0 to 28, sample count: 26
Dataset from index 28 to 40, sample count: 10
Total training samples: 26
Total validation samples: 10
Mixed precision training: True
No checkpoint found. Starting fresh training.
======================================================================
Training V3.5 (V2.5 + Physical Constraints)
======================================================================
lambda_water=8, lambda_energy=2e-05, lambda_pressure=1e-08
lambda_temperature=0.03, lambda_momentum=10.0
lambda_focus=0.1, lambda_tweedie=12.0
======================================================================
Epoch 1/50 [Train]:   0%|                                                                                                                                                                                                                          | 0/26 [00:00<?, ?it/s]/usr/local/miniconda3/envs/torch/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Loading constant masks to cuda:0...
Loaded masks: land torch.Size([721, 1440]), basin torch.Size([721, 1440])
Epoch 1/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:24<00:00,  5.55s/it, loss=5.9420, surf=1.2222, upper=1.0551, wind=E]
Epoch 1/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.40s/it, loss=5.7091, surf=1.3349, upper=1.2119]

Epoch 1/50
  Train - Total: 37.744855
         MSE - Surface: 1.876754, Upper Air: 1.345808
         Focus - Raw: 7.430832, Weighted: 0.743083
         Tweedie - Raw: 1.76e-01, Weighted: 2.117738
         Physical Raw - Water: 5.31e-02, Energy: 4.32e+04, Pressure: 4.44e+07, Temp: 9.12e+02, Mom: 2.58e-01
         Physical Weighted - Water: 0.424719, Energy: 0.863420, Pressure: 0.443753, Temp: 27.346132, Mom: 2.583448
  Valid - Total: 6.004756
         MSE - Surface: 1.150803, Upper Air: 1.223482
         Focus - Raw: 4.934519, Weighted: 0.493452
         Tweedie - Raw: 4.58e-02, Weighted: 0.549380
         Physical Raw - Water: 2.94e-02, Energy: 4.92e+03, Pressure: 3.48e+07, Temp: 2.43e+01, Mom: 1.18e-01
         Physical Weighted - Water: 0.235065, Energy: 0.098306, Pressure: 0.347604, Temp: 0.727586, Mom: 1.179078
Epoch 2/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.44s/it, loss=4.2574, surf=1.2366, upper=0.8667, wind=E]
Epoch 2/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it, loss=4.1213, surf=1.2338, upper=0.8700]

Epoch 2/50
  Train - Total: 5.327290
         MSE - Surface: 1.130550, Upper Air: 0.931161
         Focus - Raw: 4.145261, Weighted: 0.414526
         Tweedie - Raw: 3.11e-02, Weighted: 0.373150
         Physical Raw - Water: 2.32e-02, Energy: 6.18e+03, Pressure: 3.35e+07, Temp: 3.10e+01, Mom: 9.02e-02
         Physical Weighted - Water: 0.185497, Energy: 0.123575, Pressure: 0.335023, Temp: 0.931349, Mom: 0.902459
  Valid - Total: 3.785722
         MSE - Surface: 0.946886, Upper Air: 0.869402
         Focus - Raw: 4.258023, Weighted: 0.425802
         Tweedie - Raw: 3.10e-02, Weighted: 0.372578
         Physical Raw - Water: 1.60e-02, Energy: 4.35e+03, Pressure: 3.09e+07, Temp: 6.39e+00, Mom: 4.55e-02
         Physical Weighted - Water: 0.127782, Energy: 0.087022, Pressure: 0.309483, Temp: 0.191711, Mom: 0.455057
Epoch 3/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.21s/it, loss=3.4950, surf=1.1038, upper=0.7097, wind=E]
Epoch 3/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.45s/it, loss=3.8213, surf=1.2578, upper=0.7461]

Epoch 3/50
  Train - Total: 3.850271
         MSE - Surface: 1.014766, Upper Air: 0.722302
         Focus - Raw: 3.748703, Weighted: 0.374870
         Tweedie - Raw: 3.11e-02, Weighted: 0.372800
         Physical Raw - Water: 1.51e-02, Energy: 3.42e+03, Pressure: 2.82e+07, Temp: 8.24e+00, Mom: 6.47e-02
         Physical Weighted - Water: 0.120703, Energy: 0.068389, Pressure: 0.282362, Temp: 0.247080, Mom: 0.646999
  Valid - Total: 3.629612
         MSE - Surface: 0.942902, Upper Air: 0.733870
         Focus - Raw: 4.054203, Weighted: 0.405420
         Tweedie - Raw: 3.33e-02, Weighted: 0.399623
         Physical Raw - Water: 1.17e-02, Energy: 2.95e+03, Pressure: 3.15e+07, Temp: 4.14e+00, Mom: 5.55e-02
         Physical Weighted - Water: 0.093751, Energy: 0.058946, Pressure: 0.315331, Temp: 0.124274, Mom: 0.555494
Epoch 4/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.23s/it, loss=2.7614, surf=0.7928, upper=0.6458, wind=E]
Epoch 4/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.34s/it, loss=3.3909, surf=1.1747, upper=0.6708]

Epoch 4/50
  Train - Total: 3.061307
         MSE - Surface: 0.978757, Upper Air: 0.626669
         Focus - Raw: 3.371714, Weighted: 0.337171
         Tweedie - Raw: 2.80e-02, Weighted: 0.335958
         Physical Raw - Water: 1.20e-02, Energy: 3.50e+03, Pressure: 2.08e+07, Temp: 1.63e+00, Mom: 3.60e-02
         Physical Weighted - Water: 0.095904, Energy: 0.069900, Pressure: 0.207640, Temp: 0.048894, Mom: 0.360414
  Valid - Total: 3.074440
         MSE - Surface: 0.848754, Upper Air: 0.654342
         Focus - Raw: 3.346843, Weighted: 0.334684
         Tweedie - Raw: 2.83e-02, Weighted: 0.339967
         Physical Raw - Water: 1.20e-02, Energy: 2.76e+03, Pressure: 2.95e+07, Temp: 1.15e+00, Mom: 4.16e-02
         Physical Weighted - Water: 0.095612, Energy: 0.055286, Pressure: 0.295299, Temp: 0.034501, Mom: 0.415994
Epoch 5/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:19<00:00,  5.38s/it, loss=2.5085, surf=0.7464, upper=0.5852, wind=E]
Epoch 5/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=3.0167, surf=1.1700, upper=0.6520]

Epoch 5/50
  Train - Total: 2.779204
         MSE - Surface: 0.921813, Upper Air: 0.591421
         Focus - Raw: 2.968448, Weighted: 0.296845
         Tweedie - Raw: 2.39e-02, Weighted: 0.286665
         Physical Raw - Water: 1.08e-02, Energy: 3.06e+03, Pressure: 1.63e+07, Temp: 1.02e+00, Mom: 3.41e-02
         Physical Weighted - Water: 0.086712, Energy: 0.061124, Pressure: 0.162798, Temp: 0.030741, Mom: 0.341086
  Valid - Total: 2.599997
         MSE - Surface: 0.827895, Upper Air: 0.632219
         Focus - Raw: 3.181872, Weighted: 0.318187
         Tweedie - Raw: 2.41e-02, Weighted: 0.289529
         Physical Raw - Water: 9.52e-03, Energy: 2.40e+03, Pressure: 1.94e+07, Temp: 2.89e-01, Mom: 2.05e-02
         Physical Weighted - Water: 0.076192, Energy: 0.048047, Pressure: 0.194436, Temp: 0.008663, Mom: 0.204829
Epoch 6/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.51s/it, loss=2.7015, surf=0.7871, upper=0.6461, wind=E]
Epoch 6/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=3.0582, surf=1.1590, upper=0.6193]

Epoch 6/50
  Train - Total: 2.526290
         MSE - Surface: 0.868750, Upper Air: 0.562939
         Focus - Raw: 2.913385, Weighted: 0.291338
         Tweedie - Raw: 2.35e-02, Weighted: 0.282525
         Physical Raw - Water: 8.82e-03, Energy: 2.60e+03, Pressure: 1.25e+07, Temp: 3.36e-01, Mom: 2.63e-02
         Physical Weighted - Water: 0.070571, Energy: 0.051934, Pressure: 0.124863, Temp: 0.010082, Mom: 0.263287
  Valid - Total: 2.691098
         MSE - Surface: 0.806732, Upper Air: 0.601999
         Focus - Raw: 3.333834, Weighted: 0.333383
         Tweedie - Raw: 2.42e-02, Weighted: 0.290785
         Physical Raw - Water: 7.80e-03, Energy: 4.90e+03, Pressure: 2.26e+07, Temp: 5.27e-01, Mom: 2.56e-02
         Physical Weighted - Water: 0.062417, Energy: 0.097986, Pressure: 0.226308, Temp: 0.015804, Mom: 0.255683
Epoch 7/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.26s/it, loss=2.4283, surf=0.9420, upper=0.5740, wind=E]
Epoch 7/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.8888, surf=1.1510, upper=0.6034]

Epoch 7/50
  Train - Total: 2.335871
         MSE - Surface: 0.816983, Upper Air: 0.543324
         Focus - Raw: 2.814929, Weighted: 0.281493
         Tweedie - Raw: 2.21e-02, Weighted: 0.265018
         Physical Raw - Water: 8.22e-03, Energy: 2.44e+03, Pressure: 1.12e+07, Temp: 3.19e-01, Mom: 1.93e-02
         Physical Weighted - Water: 0.065728, Energy: 0.048853, Pressure: 0.111545, Temp: 0.009556, Mom: 0.193371
  Valid - Total: 2.446342
         MSE - Surface: 0.789885, Upper Air: 0.585151
         Focus - Raw: 3.099132, Weighted: 0.309913
         Tweedie - Raw: 2.26e-02, Weighted: 0.271211
         Physical Raw - Water: 6.76e-03, Energy: 3.60e+03, Pressure: 2.32e+07, Temp: 1.65e-01, Mom: 1.28e-02
         Physical Weighted - Water: 0.054054, Energy: 0.071985, Pressure: 0.231639, Temp: 0.004958, Mom: 0.127546
Epoch 8/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.24s/it, loss=2.4745, surf=0.9271, upper=0.5879, wind=E]
Epoch 8/50 [Valid]: 100%|█████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it, loss=2.7300, surf=1.1325, upper=0.5887]

Epoch 8/50
  Train - Total: 2.204556
         MSE - Surface: 0.783454, Upper Air: 0.526670
         Focus - Raw: 2.740230, Weighted: 0.274023
         Tweedie - Raw: 2.12e-02, Weighted: 0.254506
         Physical Raw - Water: 6.79e-03, Energy: 2.19e+03, Pressure: 1.02e+07, Temp: 9.60e-02, Mom: 1.63e-02
         Physical Weighted - Water: 0.054295, Energy: 0.043833, Pressure: 0.102134, Temp: 0.002880, Mom: 0.162761
  Valid - Total: 2.257408
         MSE - Surface: 0.746367, Upper Air: 0.569583
         Focus - Raw: 2.984652, Weighted: 0.298465
         Tweedie - Raw: 2.18e-02, Weighted: 0.261667
         Physical Raw - Water: 6.11e-03, Energy: 2.28e+03, Pressure: 1.86e+07, Temp: 8.26e-02, Mom: 9.86e-03
         Physical Weighted - Water: 0.048896, Energy: 0.045560, Pressure: 0.185759, Temp: 0.002479, Mom: 0.098632
Epoch 9/50 [Train]: 100%|█████████████████████████| 26/26 [02:16<00:00,  5.27s/it, loss=2.2286, surf=0.7065, upper=0.5434, wind=E]
Epoch 9/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:32<00:00,  3.29s/it, loss=2.7335, surf=1.1345, upper=0.5806]

Epoch 9/50
  Train - Total: 2.149400
         MSE - Surface: 0.767696, Upper Air: 0.514352
         Focus - Raw: 2.744427, Weighted: 0.274443
         Tweedie - Raw: 2.28e-02, Weighted: 0.274174
         Physical Raw - Water: 6.78e-03, Energy: 2.07e+03, Pressure: 9.24e+06, Temp: 9.77e-02, Mom: 1.28e-02
         Physical Weighted - Water: 0.054255, Energy: 0.041331, Pressure: 0.092409, Temp: 0.002930, Mom: 0.127810
  Valid - Total: 2.289994
         MSE - Surface: 0.759426, Upper Air: 0.562512
         Focus - Raw: 2.969299, Weighted: 0.296930
         Tweedie - Raw: 2.34e-02, Weighted: 0.281211
         Physical Raw - Water: 7.28e-03, Energy: 2.66e+03, Pressure: 1.97e+07, Temp: 1.84e-01, Mom: 7.63e-03
         Physical Weighted - Water: 0.058275, Energy: 0.053165, Pressure: 0.196634, Temp: 0.005531, Mom: 0.076311
Epoch 10/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.23s/it, loss=2.0621, surf=0.6869, upper=0.5377, wind=E]
Epoch 10/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.7642, surf=1.2408, upper=0.5715]

Epoch 10/50
  Train - Total: 2.080118
         MSE - Surface: 0.749245, Upper Air: 0.507432
         Focus - Raw: 2.717967, Weighted: 0.271797
         Tweedie - Raw: 2.12e-02, Weighted: 0.253881
         Physical Raw - Water: 6.47e-03, Energy: 2.06e+03, Pressure: 7.94e+06, Temp: 1.02e-01, Mom: 1.22e-02
         Physical Weighted - Water: 0.051772, Energy: 0.041238, Pressure: 0.079383, Temp: 0.003050, Mom: 0.122321
  Valid - Total: 2.233285
         MSE - Surface: 0.773570, Upper Air: 0.553894
         Focus - Raw: 2.885488, Weighted: 0.288549
         Tweedie - Raw: 2.06e-02, Weighted: 0.247639
         Physical Raw - Water: 5.46e-03, Energy: 2.06e+03, Pressure: 1.90e+07, Temp: 7.55e-02, Mom: 9.28e-03
         Physical Weighted - Water: 0.043664, Energy: 0.041215, Pressure: 0.189702, Temp: 0.002266, Mom: 0.092786
Epoch 11/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.39s/it, loss=1.8424, surf=0.5833, upper=0.5437, wind=E]
Epoch 11/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.41s/it, loss=2.7044, surf=1.1649, upper=0.5684]

Epoch 11/50
  Train - Total: 2.028127
         MSE - Surface: 0.724883, Upper Air: 0.505211
         Focus - Raw: 2.661094, Weighted: 0.266109
         Tweedie - Raw: 2.08e-02, Weighted: 0.249120
         Physical Raw - Water: 6.07e-03, Energy: 1.94e+03, Pressure: 6.89e+06, Temp: 7.15e-02, Mom: 1.24e-02
         Physical Weighted - Water: 0.048599, Energy: 0.038709, Pressure: 0.068913, Temp: 0.002145, Mom: 0.124437
  Valid - Total: 2.158396
         MSE - Surface: 0.722844, Upper Air: 0.549618
         Focus - Raw: 2.930692, Weighted: 0.293069
         Tweedie - Raw: 2.16e-02, Weighted: 0.259213
         Physical Raw - Water: 5.32e-03, Energy: 2.39e+03, Pressure: 1.71e+07, Temp: 6.21e-02, Mom: 7.03e-03
         Physical Weighted - Water: 0.042546, Energy: 0.047720, Pressure: 0.171219, Temp: 0.001862, Mom: 0.070306
Epoch 12/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.29s/it, loss=2.0381, surf=0.8658, upper=0.4763, wind=E]
Epoch 12/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.49s/it, loss=2.7385, surf=1.2215, upper=0.5593]

Epoch 12/50
  Train - Total: 1.949449
         MSE - Surface: 0.704867, Upper Air: 0.498238
         Focus - Raw: 2.672281, Weighted: 0.267228
         Tweedie - Raw: 2.05e-02, Weighted: 0.246527
         Physical Raw - Water: 5.44e-03, Energy: 1.83e+03, Pressure: 6.44e+06, Temp: 5.86e-02, Mom: 8.63e-03
         Physical Weighted - Water: 0.043495, Energy: 0.036578, Pressure: 0.064428, Temp: 0.001759, Mom: 0.086329
  Valid - Total: 2.185626
         MSE - Surface: 0.738573, Upper Air: 0.541202
         Focus - Raw: 2.879290, Weighted: 0.287929
         Tweedie - Raw: 2.19e-02, Weighted: 0.262610
         Physical Raw - Water: 5.38e-03, Energy: 3.80e+03, Pressure: 1.65e+07, Temp: 8.78e-02, Mom: 6.90e-03
         Physical Weighted - Water: 0.043006, Energy: 0.076042, Pressure: 0.164626, Temp: 0.002634, Mom: 0.069004
Epoch 13/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:19<00:00,  5.35s/it, loss=2.0645, surf=0.7557, upper=0.5270, wind=E]
Epoch 13/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.38s/it, loss=2.6368, surf=1.1733, upper=0.5531]

Epoch 13/50
  Train - Total: 1.914176
         MSE - Surface: 0.706147, Upper Air: 0.492652
         Focus - Raw: 2.645019, Weighted: 0.264502
         Tweedie - Raw: 2.00e-02, Weighted: 0.240263
         Physical Raw - Water: 5.95e-03, Energy: 1.58e+03, Pressure: 6.51e+06, Temp: 3.60e-02, Mom: 6.53e-03
         Physical Weighted - Water: 0.047615, Energy: 0.031540, Pressure: 0.065101, Temp: 0.001081, Mom: 0.065276
  Valid - Total: 2.151316
         MSE - Surface: 0.763576, Upper Air: 0.534356
         Focus - Raw: 2.928840, Weighted: 0.292884
         Tweedie - Raw: 2.20e-02, Weighted: 0.263564
         Physical Raw - Water: 6.06e-03, Energy: 2.47e+03, Pressure: 1.61e+07, Temp: 4.95e-02, Mom: 3.68e-03
         Physical Weighted - Water: 0.048492, Energy: 0.049390, Pressure: 0.160798, Temp: 0.001485, Mom: 0.036771
Epoch 14/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:18<00:00,  5.31s/it, loss=2.0147, surf=0.5963, upper=0.5907, wind=E]
Epoch 14/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:35<00:00,  3.51s/it, loss=2.6243, surf=1.1162, upper=0.5525]

Epoch 14/50
  Train - Total: 1.899900
         MSE - Surface: 0.696194, Upper Air: 0.490211
         Focus - Raw: 2.627079, Weighted: 0.262708
         Tweedie - Raw: 1.98e-02, Weighted: 0.238196
         Physical Raw - Water: 5.77e-03, Energy: 2.15e+03, Pressure: 6.16e+06, Temp: 3.78e-02, Mom: 6.07e-03
         Physical Weighted - Water: 0.046158, Energy: 0.042968, Pressure: 0.061645, Temp: 0.001135, Mom: 0.060685
  Valid - Total: 2.162192
         MSE - Surface: 0.709729, Upper Air: 0.533949
         Focus - Raw: 2.876743, Weighted: 0.287674
         Tweedie - Raw: 2.35e-02, Weighted: 0.281931
         Physical Raw - Water: 5.22e-03, Energy: 2.98e+03, Pressure: 1.81e+07, Temp: 4.96e-02, Mom: 6.48e-03
         Physical Weighted - Water: 0.041761, Energy: 0.059562, Pressure: 0.181292, Temp: 0.001489, Mom: 0.064805
Epoch 15/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.45s/it, loss=1.7718, surf=0.5601, upper=0.5269, wind=E]
Epoch 15/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.32s/it, loss=2.6153, surf=1.1255, upper=0.5524]

Epoch 15/50
  Train - Total: 1.935776
         MSE - Surface: 0.685950, Upper Air: 0.488645
         Focus - Raw: 2.650108, Weighted: 0.265011
         Tweedie - Raw: 2.08e-02, Weighted: 0.249435
         Physical Raw - Water: 6.40e-03, Energy: 1.61e+03, Pressure: 6.05e+06, Temp: 4.22e-02, Mom: 1.02e-02
         Physical Weighted - Water: 0.051236, Energy: 0.032233, Pressure: 0.060471, Temp: 0.001267, Mom: 0.101527
  Valid - Total: 2.122840
         MSE - Surface: 0.706827, Upper Air: 0.533550
         Focus - Raw: 2.955633, Weighted: 0.295563
         Tweedie - Raw: 2.09e-02, Weighted: 0.250637
         Physical Raw - Water: 5.78e-03, Energy: 2.23e+03, Pressure: 1.81e+07, Temp: 9.87e-02, Mom: 6.16e-03
         Physical Weighted - Water: 0.046210, Energy: 0.044656, Pressure: 0.180849, Temp: 0.002961, Mom: 0.061586
Epoch 16/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:22<00:00,  5.48s/it, loss=1.9636, surf=0.7058, upper=0.5444, wind=E]
Epoch 16/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:35<00:00,  3.51s/it, loss=2.5657, surf=1.1082, upper=0.5469]

Epoch 16/50
  Train - Total: 1.863221
         MSE - Surface: 0.678320, Upper Air: 0.483966
         Focus - Raw: 2.610408, Weighted: 0.261041
         Tweedie - Raw: 1.98e-02, Weighted: 0.237171
         Physical Raw - Water: 5.32e-03, Energy: 1.74e+03, Pressure: 5.75e+06, Temp: 2.60e-02, Mom: 6.71e-03
         Physical Weighted - Water: 0.042527, Energy: 0.034734, Pressure: 0.057543, Temp: 0.000779, Mom: 0.067141
  Valid - Total: 2.104197
         MSE - Surface: 0.720391, Upper Air: 0.529696
         Focus - Raw: 2.848732, Weighted: 0.284873
         Tweedie - Raw: 2.07e-02, Weighted: 0.248728
         Physical Raw - Water: 5.61e-03, Energy: 1.35e+03, Pressure: 1.86e+07, Temp: 4.47e-02, Mom: 6.10e-03
         Physical Weighted - Water: 0.044899, Energy: 0.026994, Pressure: 0.186273, Temp: 0.001341, Mom: 0.061002
Epoch 17/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=1.6558, surf=0.6067, upper=0.4197, wind=E]
Epoch 17/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.33s/it, loss=2.6013, surf=1.1541, upper=0.5466]

Epoch 17/50
  Train - Total: 1.832329
         MSE - Surface: 0.668683, Upper Air: 0.483755
         Focus - Raw: 2.602230, Weighted: 0.260223
         Tweedie - Raw: 1.93e-02, Weighted: 0.231015
         Physical Raw - Water: 5.10e-03, Energy: 1.40e+03, Pressure: 6.07e+06, Temp: 4.37e-02, Mom: 5.79e-03
         Physical Weighted - Water: 0.040786, Energy: 0.027982, Pressure: 0.060679, Temp: 0.001311, Mom: 0.057893
  Valid - Total: 2.080375
         MSE - Surface: 0.711036, Upper Air: 0.526305
         Focus - Raw: 2.882982, Weighted: 0.288298
         Tweedie - Raw: 2.31e-02, Weighted: 0.276662
         Physical Raw - Water: 5.20e-03, Energy: 1.59e+03, Pressure: 1.60e+07, Temp: 7.13e-02, Mom: 4.30e-03
         Physical Weighted - Water: 0.041572, Energy: 0.031769, Pressure: 0.159574, Temp: 0.002138, Mom: 0.043022
Epoch 18/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.40s/it, loss=1.5840, surf=0.5443, upper=0.4118, wind=E]
Epoch 18/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.43s/it, loss=2.6247, surf=1.1458, upper=0.5422]

Epoch 18/50
  Train - Total: 1.833718
         MSE - Surface: 0.679096, Upper Air: 0.481210
         Focus - Raw: 2.591130, Weighted: 0.259113
         Tweedie - Raw: 1.94e-02, Weighted: 0.232246
         Physical Raw - Water: 5.09e-03, Energy: 2.55e+03, Pressure: 5.24e+06, Temp: 2.56e-02, Mom: 3.72e-03
         Physical Weighted - Water: 0.040758, Energy: 0.050924, Pressure: 0.052392, Temp: 0.000769, Mom: 0.037209
  Valid - Total: 2.126621
         MSE - Surface: 0.714662, Upper Air: 0.523794
         Focus - Raw: 2.841529, Weighted: 0.284153
         Tweedie - Raw: 2.26e-02, Weighted: 0.271480
         Physical Raw - Water: 4.79e-03, Energy: 2.49e+03, Pressure: 1.69e+07, Temp: 4.25e-02, Mom: 7.46e-03
         Physical Weighted - Water: 0.038288, Energy: 0.049853, Pressure: 0.168550, Temp: 0.001275, Mom: 0.074565
Epoch 19/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.52s/it, loss=1.7063, surf=0.5213, upper=0.4973, wind=E]
Epoch 19/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.35s/it, loss=2.6256, surf=1.1540, upper=0.5500]

Epoch 19/50
  Train - Total: 1.811847
         MSE - Surface: 0.662404, Upper Air: 0.484310
         Focus - Raw: 2.595938, Weighted: 0.259594
         Tweedie - Raw: 1.97e-02, Weighted: 0.236833
         Physical Raw - Water: 4.77e-03, Energy: 1.45e+03, Pressure: 4.98e+06, Temp: 5.79e-02, Mom: 5.00e-03
         Physical Weighted - Water: 0.038121, Energy: 0.029092, Pressure: 0.049774, Temp: 0.001737, Mom: 0.049983
  Valid - Total: 2.095717
         MSE - Surface: 0.691995, Upper Air: 0.531868
         Focus - Raw: 2.859134, Weighted: 0.285913
         Tweedie - Raw: 2.30e-02, Weighted: 0.275914
         Physical Raw - Water: 4.24e-03, Energy: 1.38e+03, Pressure: 1.88e+07, Temp: 9.98e-02, Mom: 5.74e-03
         Physical Weighted - Water: 0.033959, Energy: 0.027568, Pressure: 0.188068, Temp: 0.002993, Mom: 0.057438
Epoch 20/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.21s/it, loss=1.7054, surf=0.6195, upper=0.4234, wind=E]
Epoch 20/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.48s/it, loss=2.7357, surf=1.2684, upper=0.5386]

Epoch 20/50
  Train - Total: 1.791976
         MSE - Surface: 0.655838, Upper Air: 0.482878
         Focus - Raw: 2.575865, Weighted: 0.257586
         Tweedie - Raw: 1.95e-02, Weighted: 0.234506
         Physical Raw - Water: 4.58e-03, Energy: 1.48e+03, Pressure: 5.11e+06, Temp: 3.85e-02, Mom: 4.27e-03
         Physical Weighted - Water: 0.036660, Energy: 0.029582, Pressure: 0.051112, Temp: 0.001154, Mom: 0.042660
  Valid - Total: 2.184983
         MSE - Surface: 0.773418, Upper Air: 0.520166
         Focus - Raw: 2.846492, Weighted: 0.284649
         Tweedie - Raw: 2.09e-02, Weighted: 0.250962
         Physical Raw - Water: 4.32e-03, Energy: 3.80e+03, Pressure: 1.85e+07, Temp: 3.89e-02, Mom: 5.88e-03
         Physical Weighted - Water: 0.034556, Energy: 0.075907, Pressure: 0.185356, Temp: 0.001166, Mom: 0.058803
Epoch 21/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.22s/it, loss=1.7631, surf=0.7018, upper=0.4351, wind=E]
Epoch 21/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=2.5109, surf=1.1183, upper=0.5374]

Epoch 21/50
  Train - Total: 1.829058
         MSE - Surface: 0.668472, Upper Air: 0.477318
         Focus - Raw: 2.603291, Weighted: 0.260329
         Tweedie - Raw: 2.08e-02, Weighted: 0.249655
         Physical Raw - Water: 5.01e-03, Energy: 1.43e+03, Pressure: 5.71e+06, Temp: 1.53e-02, Mom: 4.70e-03
         Physical Weighted - Water: 0.040109, Energy: 0.028629, Pressure: 0.057132, Temp: 0.000459, Mom: 0.046956
  Valid - Total: 2.038627
         MSE - Surface: 0.682433, Upper Air: 0.518402
         Focus - Raw: 2.820587, Weighted: 0.282059
         Tweedie - Raw: 2.36e-02, Weighted: 0.283585
         Physical Raw - Water: 4.21e-03, Energy: 1.69e+03, Pressure: 1.62e+07, Temp: 2.93e-02, Mom: 4.15e-03
         Physical Weighted - Water: 0.033708, Energy: 0.033773, Pressure: 0.162265, Temp: 0.000878, Mom: 0.041525
Epoch 22/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:28<00:00,  5.73s/it, loss=1.9313, surf=0.6980, upper=0.5178, wind=E]
Epoch 22/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.43s/it, loss=2.5625, surf=1.1742, upper=0.5354]

Epoch 22/50
  Train - Total: 1.764854
         MSE - Surface: 0.650199, Upper Air: 0.476504
         Focus - Raw: 2.579105, Weighted: 0.257911
         Tweedie - Raw: 1.95e-02, Weighted: 0.233667
         Physical Raw - Water: 4.57e-03, Energy: 1.21e+03, Pressure: 5.01e+06, Temp: 1.74e-02, Mom: 3.52e-03
         Physical Weighted - Water: 0.036529, Energy: 0.024200, Pressure: 0.050144, Temp: 0.000521, Mom: 0.035181
  Valid - Total: 2.025235
         MSE - Surface: 0.701084, Upper Air: 0.516599
         Focus - Raw: 2.848919, Weighted: 0.284892
         Tweedie - Raw: 2.15e-02, Weighted: 0.257766
         Physical Raw - Water: 4.12e-03, Energy: 1.19e+03, Pressure: 1.76e+07, Temp: 2.55e-02, Mom: 3.13e-03
         Physical Weighted - Water: 0.032955, Energy: 0.023774, Pressure: 0.176099, Temp: 0.000764, Mom: 0.031302
Epoch 23/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:22<00:00,  5.47s/it, loss=1.5655, surf=0.5433, upper=0.4208, wind=E]
Epoch 23/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.46s/it, loss=2.4706, surf=1.1233, upper=0.5338]

Epoch 23/50
  Train - Total: 1.746355
         MSE - Surface: 0.640781, Upper Air: 0.473993
         Focus - Raw: 2.561879, Weighted: 0.256188
         Tweedie - Raw: 1.98e-02, Weighted: 0.237255
         Physical Raw - Water: 4.33e-03, Energy: 1.16e+03, Pressure: 4.91e+06, Temp: 1.31e-02, Mom: 3.08e-03
         Physical Weighted - Water: 0.034628, Energy: 0.023258, Pressure: 0.049096, Temp: 0.000392, Mom: 0.030763
  Valid - Total: 1.975621
         MSE - Surface: 0.682839, Upper Air: 0.514567
         Focus - Raw: 2.833491, Weighted: 0.283349
         Tweedie - Raw: 2.14e-02, Weighted: 0.256864
         Physical Raw - Water: 4.09e-03, Energy: 1.29e+03, Pressure: 1.45e+07, Temp: 6.20e-02, Mom: 3.28e-03
         Physical Weighted - Water: 0.032696, Energy: 0.025879, Pressure: 0.144781, Temp: 0.001860, Mom: 0.032786
Epoch 24/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.42s/it, loss=1.6894, surf=0.6604, upper=0.4308, wind=E]
Epoch 24/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.34s/it, loss=2.5365, surf=1.1483, upper=0.5350]

Epoch 24/50
  Train - Total: 1.736038
         MSE - Surface: 0.633075, Upper Air: 0.473352
         Focus - Raw: 2.575562, Weighted: 0.257556
         Tweedie - Raw: 1.94e-02, Weighted: 0.232317
         Physical Raw - Water: 4.55e-03, Energy: 1.35e+03, Pressure: 5.09e+06, Temp: 1.53e-02, Mom: 2.49e-03
         Physical Weighted - Water: 0.036432, Energy: 0.027042, Pressure: 0.050934, Temp: 0.000459, Mom: 0.024871
  Valid - Total: 1.990697
         MSE - Surface: 0.683319, Upper Air: 0.514905
         Focus - Raw: 2.832598, Weighted: 0.283260
         Tweedie - Raw: 2.18e-02, Weighted: 0.261410
         Physical Raw - Water: 4.18e-03, Energy: 1.35e+03, Pressure: 1.60e+07, Temp: 2.55e-02, Mom: 2.63e-03
         Physical Weighted - Water: 0.033437, Energy: 0.026910, Pressure: 0.160423, Temp: 0.000764, Mom: 0.026268
Epoch 25/50 [Train]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.44s/it, loss=1.7139, surf=0.6975, upper=0.4280, wind=E]
Epoch 25/50 [Valid]: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.50s/it, loss=2.4812, surf=1.0750, upper=0.5329]

Epoch 25/50
  Train - Total: 1.740539
         MSE - Surface: 0.631302, Upper Air: 0.471870
         Focus - Raw: 2.556944, Weighted: 0.255694
         Tweedie - Raw: 1.94e-02, Weighted: 0.232254
         Physical Raw - Water: 4.34e-03, Energy: 1.53e+03, Pressure: 4.88e+06, Temp: 2.22e-02, Mom: 3.46e-03
         Physical Weighted - Water: 0.034709, Energy: 0.030569, Pressure: 0.048830, Temp: 0.000667, Mom: 0.034644
  Valid - Total: 2.009154
         MSE - Surface: 0.662245, Upper Air: 0.513865
         Focus - Raw: 2.855547, Weighted: 0.285555
         Tweedie - Raw: 2.13e-02, Weighted: 0.255352
         Physical Raw - Water: 3.92e-03, Energy: 1.58e+03, Pressure: 2.01e+07, Temp: 7.41e-02, Mom: 2.59e-03
         Physical Weighted - Water: 0.031391, Energy: 0.031541, Pressure: 0.201126, Temp: 0.002224, Mom: 0.025855
  Saved checkpoint: checkpoints_v3_5/model_v3_5_epoch25.pth


Epoch 26/50
  Train - Total: 1.902004
         MSE - Surface: 0.686980, Upper Air: 0.482643
         Focus - Raw: 2.633857, Weighted: 0.263386
         Tweedie - Raw: 2.09e-02, Weighted: 0.250604
         Physical Raw - Water: 5.93e-03, Energy: 3.21e+03, Pressure: 1.06e+07, Temp: 3.48e-03, Mom: 3.09e-03
         Physical Weighted - Water: 0.047405, Energy: 0.064201, Pressure: 0.106167, Temp: 0.000002, Mom: 0.000617
  Valid - Total: 2.040516
         MSE - Surface: 0.700162, Upper Air: 0.516791
         Focus - Raw: 2.888249, Weighted: 0.288825
         Tweedie - Raw: 2.17e-02, Weighted: 0.260958
         Physical Raw - Water: 4.73e-03, Energy: 1.49e+03, Pressure: 2.06e+07, Temp: 5.61e-03, Mom: 1.73e-03
         Physical Weighted - Water: 0.037878, Energy: 0.029761, Pressure: 0.205790, Temp: 0.000003, Mom: 0.000347
Epoch 27/50 [Train]:  58%|█████████████████████████████████████████████████████████████████████████████████████▉                                                               | 15/26 [01:35<00:44,  4.08s/it, loss=1.7817, surf=0.5727, upper=0.5394, wind=E]Epoch 27/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:19<00:00,  5.38s/it, loss=1.7783, surf=0.6597, upper=0.4997, wind=E]
Epoch 27/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.43s/it, loss=2.5439, surf=1.1941, upper=0.5270]

Epoch 27/50
  Train - Total: 1.737580
         MSE - Surface: 0.644943, Upper Air: 0.476916
         Focus - Raw: 2.585354, Weighted: 0.258535
         Tweedie - Raw: 1.93e-02, Weighted: 0.231406
         Physical Raw - Water: 4.55e-03, Energy: 1.27e+03, Pressure: 6.37e+06, Temp: 1.18e-02, Mom: 1.28e-03
         Physical Weighted - Water: 0.036399, Energy: 0.025391, Pressure: 0.063725, Temp: 0.000007, Mom: 0.000256
  Valid - Total: 1.988617
         MSE - Surface: 0.703720, Upper Air: 0.508521
         Focus - Raw: 2.855059, Weighted: 0.285506
         Tweedie - Raw: 2.19e-02, Weighted: 0.263039
         Physical Raw - Water: 3.79e-03, Energy: 1.41e+03, Pressure: 1.69e+07, Temp: 1.53e-02, Mom: 1.16e-03
         Physical Weighted - Water: 0.030358, Energy: 0.028155, Pressure: 0.169076, Temp: 0.000009, Mom: 0.000233
Epoch 28/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.28s/it, loss=1.8562, surf=0.6791, upper=0.5157, wind=E]
Epoch 28/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.40s/it, loss=2.4750, surf=1.0644, upper=0.5217]

Epoch 28/50
  Train - Total: 1.689348
         MSE - Surface: 0.619080, Upper Air: 0.470493
         Focus - Raw: 2.569614, Weighted: 0.256961
         Tweedie - Raw: 1.97e-02, Weighted: 0.236161
         Physical Raw - Water: 4.05e-03, Energy: 1.27e+03, Pressure: 4.86e+06, Temp: 4.01e-03, Mom: 9.75e-04
         Physical Weighted - Water: 0.032426, Energy: 0.025445, Pressure: 0.048584, Temp: 0.000002, Mom: 0.000195
  Valid - Total: 1.996823
         MSE - Surface: 0.650202, Upper Air: 0.503210
         Focus - Raw: 2.831618, Weighted: 0.283162
         Tweedie - Raw: 2.68e-02, Weighted: 0.321693
         Physical Raw - Water: 3.74e-03, Energy: 1.56e+03, Pressure: 1.77e+07, Temp: 2.70e-03, Mom: 1.24e-03
         Physical Weighted - Water: 0.029884, Energy: 0.031246, Pressure: 0.177176, Temp: 0.000002, Mom: 0.000249
Epoch 29/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.20s/it, loss=1.5999, surf=0.5119, upper=0.4953, wind=E]
Epoch 29/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.42s/it, loss=2.4501, surf=1.0945, upper=0.5208]

Epoch 29/50
  Train - Total: 1.662796
         MSE - Surface: 0.616198, Upper Air: 0.466635
         Focus - Raw: 2.544496, Weighted: 0.254450
         Tweedie - Raw: 1.88e-02, Weighted: 0.225988
         Physical Raw - Water: 3.88e-03, Energy: 1.13e+03, Pressure: 4.57e+06, Temp: 4.04e-03, Mom: 8.10e-04
         Physical Weighted - Water: 0.031056, Energy: 0.022603, Pressure: 0.045704, Temp: 0.000002, Mom: 0.000162
  Valid - Total: 1.958836
         MSE - Surface: 0.664939, Upper Air: 0.504295
         Focus - Raw: 2.807096, Weighted: 0.280710
         Tweedie - Raw: 2.14e-02, Weighted: 0.256562
         Physical Raw - Water: 4.23e-03, Energy: 1.37e+03, Pressure: 1.91e+07, Temp: 4.10e-02, Mom: 9.78e-04
         Physical Weighted - Water: 0.033869, Energy: 0.027360, Pressure: 0.190881, Temp: 0.000025, Mom: 0.000196
Epoch 30/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:22<00:00,  5.48s/it, loss=1.5976, surf=0.5056, upper=0.4783, wind=E]
Epoch 30/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:35<00:00,  3.51s/it, loss=2.4007, surf=1.0868, upper=0.5245]

Epoch 30/50
  Train - Total: 1.662147
         MSE - Surface: 0.614214, Upper Air: 0.466714
         Focus - Raw: 2.544096, Weighted: 0.254410
         Tweedie - Raw: 1.89e-02, Weighted: 0.226860
         Physical Raw - Water: 3.83e-03, Energy: 1.04e+03, Pressure: 4.84e+06, Temp: 5.42e-03, Mom: 8.66e-04
         Physical Weighted - Water: 0.030631, Energy: 0.020736, Pressure: 0.048406, Temp: 0.000003, Mom: 0.000173
  Valid - Total: 1.901727
         MSE - Surface: 0.653921, Upper Air: 0.505492
         Focus - Raw: 2.841054, Weighted: 0.284105
         Tweedie - Raw: 2.03e-02, Weighted: 0.243960
         Physical Raw - Water: 3.68e-03, Energy: 1.60e+03, Pressure: 1.53e+07, Temp: 4.32e-02, Mom: 9.65e-04
         Physical Weighted - Water: 0.029405, Energy: 0.031910, Pressure: 0.152715, Temp: 0.000026, Mom: 0.000193
Epoch 31/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.51s/it, loss=1.8029, surf=0.5579, upper=0.5748, wind=E]
Epoch 31/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.35s/it, loss=2.4026, surf=1.0941, upper=0.5151]

Epoch 31/50
  Train - Total: 1.678890
         MSE - Surface: 0.624341, Upper Air: 0.464691
         Focus - Raw: 2.548713, Weighted: 0.254871
         Tweedie - Raw: 1.91e-02, Weighted: 0.228703
         Physical Raw - Water: 4.26e-03, Energy: 1.09e+03, Pressure: 5.02e+06, Temp: 5.80e-03, Mom: 7.14e-04
         Physical Weighted - Water: 0.034056, Energy: 0.021896, Pressure: 0.050186, Temp: 0.000003, Mom: 0.000143
  Valid - Total: 1.913240
         MSE - Surface: 0.661349, Upper Air: 0.499322
         Focus - Raw: 2.817430, Weighted: 0.281743
         Tweedie - Raw: 2.13e-02, Weighted: 0.256027
         Physical Raw - Water: 3.68e-03, Energy: 1.90e+03, Pressure: 1.47e+07, Temp: 1.97e-02, Mom: 9.55e-04
         Physical Weighted - Water: 0.029437, Energy: 0.038057, Pressure: 0.147103, Temp: 0.000012, Mom: 0.000191
Epoch 32/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.26s/it, loss=1.7689, surf=0.6895, upper=0.4952, wind=E]
Epoch 32/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.40s/it, loss=2.3772, surf=1.0676, upper=0.5234]

Epoch 32/50
  Train - Total: 1.671549
         MSE - Surface: 0.613733, Upper Air: 0.464159
         Focus - Raw: 2.546406, Weighted: 0.254641
         Tweedie - Raw: 1.89e-02, Weighted: 0.226457
         Physical Raw - Water: 3.89e-03, Energy: 1.75e+03, Pressure: 4.64e+06, Temp: 9.11e-03, Mom: 7.01e-04
         Physical Weighted - Water: 0.031112, Energy: 0.034904, Pressure: 0.046398, Temp: 0.000005, Mom: 0.000140
  Valid - Total: 1.899607
         MSE - Surface: 0.643181, Upper Air: 0.502052
         Focus - Raw: 2.850727, Weighted: 0.285073
         Tweedie - Raw: 2.08e-02, Weighted: 0.249359
         Physical Raw - Water: 3.89e-03, Energy: 1.47e+03, Pressure: 1.59e+07, Temp: 1.40e-03, Mom: 1.11e-03
         Physical Weighted - Water: 0.031151, Energy: 0.029445, Pressure: 0.159122, Temp: 0.000001, Mom: 0.000223
Epoch 33/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.28s/it, loss=1.8328, surf=0.7115, upper=0.5236, wind=E]
Epoch 33/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=2.3854, surf=1.0111, upper=0.5193]

Epoch 33/50
  Train - Total: 1.619611
         MSE - Surface: 0.594744, Upper Air: 0.462242
         Focus - Raw: 2.519110, Weighted: 0.251911
         Tweedie - Raw: 1.83e-02, Weighted: 0.219049
         Physical Raw - Water: 3.64e-03, Energy: 1.08e+03, Pressure: 4.08e+06, Temp: 3.04e-03, Mom: 7.20e-04
         Physical Weighted - Water: 0.029116, Energy: 0.021644, Pressure: 0.040759, Temp: 0.000002, Mom: 0.000144
  Valid - Total: 1.907849
         MSE - Surface: 0.638690, Upper Air: 0.499387
         Focus - Raw: 2.783108, Weighted: 0.278311
         Tweedie - Raw: 2.14e-02, Weighted: 0.256802
         Physical Raw - Water: 3.58e-03, Energy: 2.70e+03, Pressure: 1.52e+07, Temp: 1.06e-02, Mom: 9.39e-04
         Physical Weighted - Water: 0.028647, Energy: 0.054030, Pressure: 0.151788, Temp: 0.000006, Mom: 0.000188
Epoch 34/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:13<00:00,  5.13s/it, loss=1.8082, surf=0.5934, upper=0.4907, wind=E]
Epoch 34/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.6479, surf=1.1683, upper=0.5254]

Epoch 34/50
  Train - Total: 1.642825
         MSE - Surface: 0.603965, Upper Air: 0.461036
         Focus - Raw: 2.521316, Weighted: 0.252132
         Tweedie - Raw: 1.92e-02, Weighted: 0.230907
         Physical Raw - Water: 3.76e-03, Energy: 1.03e+03, Pressure: 4.39e+06, Temp: 4.56e-03, Mom: 6.39e-04
         Physical Weighted - Water: 0.030115, Energy: 0.020638, Pressure: 0.043900, Temp: 0.000003, Mom: 0.000128
  Valid - Total: 2.090376
         MSE - Surface: 0.687574, Upper Air: 0.504022
         Focus - Raw: 2.995567, Weighted: 0.299557
         Tweedie - Raw: 2.81e-02, Weighted: 0.337709
         Physical Raw - Water: 3.85e-03, Energy: 1.77e+03, Pressure: 1.95e+07, Temp: 2.56e-02, Mom: 1.23e-03
         Physical Weighted - Water: 0.030791, Energy: 0.035404, Pressure: 0.195057, Temp: 0.000015, Mom: 0.000246
Epoch 35/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.39s/it, loss=1.6452, surf=0.5622, upper=0.4880, wind=E]
Epoch 35/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.49s/it, loss=2.5025, surf=1.1444, upper=0.5156]

Epoch 35/50
  Train - Total: 1.653823
         MSE - Surface: 0.598753, Upper Air: 0.462807
         Focus - Raw: 2.549490, Weighted: 0.254949
         Tweedie - Raw: 1.89e-02, Weighted: 0.227084
         Physical Raw - Water: 4.03e-03, Energy: 1.47e+03, Pressure: 4.84e+06, Temp: 6.09e-03, Mom: 7.69e-04
         Physical Weighted - Water: 0.032219, Energy: 0.029431, Pressure: 0.048422, Temp: 0.000004, Mom: 0.000154
  Valid - Total: 1.925087
         MSE - Surface: 0.667799, Upper Air: 0.496691
         Focus - Raw: 2.813233, Weighted: 0.281323
         Tweedie - Raw: 2.14e-02, Weighted: 0.256284
         Physical Raw - Water: 3.57e-03, Energy: 1.21e+03, Pressure: 1.70e+07, Temp: 1.68e-03, Mom: 9.73e-04
         Physical Weighted - Water: 0.028576, Energy: 0.024105, Pressure: 0.170113, Temp: 0.000001, Mom: 0.000195
Epoch 36/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.51s/it, loss=1.5786, surf=0.5173, upper=0.4949, wind=E]
Epoch 36/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:35<00:00,  3.53s/it, loss=2.4948, surf=1.1144, upper=0.5206]

Epoch 36/50
  Train - Total: 1.665431
         MSE - Surface: 0.622257, Upper Air: 0.462294
         Focus - Raw: 2.517763, Weighted: 0.251776
         Tweedie - Raw: 1.91e-02, Weighted: 0.229486
         Physical Raw - Water: 3.84e-03, Energy: 1.13e+03, Pressure: 4.61e+06, Temp: 5.30e-03, Mom: 7.28e-04
         Physical Weighted - Water: 0.030744, Energy: 0.022651, Pressure: 0.046075, Temp: 0.000003, Mom: 0.000146
  Valid - Total: 1.890049
         MSE - Surface: 0.643854, Upper Air: 0.501295
         Focus - Raw: 2.799732, Weighted: 0.279973
         Tweedie - Raw: 2.31e-02, Weighted: 0.276670
         Physical Raw - Water: 3.78e-03, Energy: 1.54e+03, Pressure: 1.27e+07, Temp: 2.20e-02, Mom: 1.00e-03
         Physical Weighted - Water: 0.030261, Energy: 0.030772, Pressure: 0.127009, Temp: 0.000013, Mom: 0.000200
Epoch 37/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.43s/it, loss=1.7149, surf=0.6958, upper=0.4395, wind=E]
Epoch 37/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=2.4747, surf=1.1692, upper=0.5191]

Epoch 37/50
  Train - Total: 1.634193
         MSE - Surface: 0.598090, Upper Air: 0.459711
         Focus - Raw: 2.511060, Weighted: 0.251106
         Tweedie - Raw: 1.90e-02, Weighted: 0.228586
         Physical Raw - Water: 3.48e-03, Energy: 1.18e+03, Pressure: 4.51e+06, Temp: 6.99e-03, Mom: 6.76e-04
         Physical Weighted - Water: 0.027858, Energy: 0.023646, Pressure: 0.045057, Temp: 0.000004, Mom: 0.000135
  Valid - Total: 1.905820
         MSE - Surface: 0.676591, Upper Air: 0.499187
         Focus - Raw: 2.798415, Weighted: 0.279841
         Tweedie - Raw: 2.08e-02, Weighted: 0.250084
         Physical Raw - Water: 3.24e-03, Energy: 1.67e+03, Pressure: 1.41e+07, Temp: 4.57e-03, Mom: 7.29e-04
         Physical Weighted - Water: 0.025956, Energy: 0.033479, Pressure: 0.140534, Temp: 0.000003, Mom: 0.000146
Epoch 38/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:18<00:00,  5.35s/it, loss=1.6933, surf=0.6430, upper=0.4845, wind=E]
Epoch 38/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.3770, surf=1.0709, upper=0.5137]

Epoch 38/50
  Train - Total: 1.604805
         MSE - Surface: 0.587271, Upper Air: 0.457880
         Focus - Raw: 2.484301, Weighted: 0.248430
         Tweedie - Raw: 1.79e-02, Weighted: 0.214623
         Physical Raw - Water: 3.40e-03, Energy: 1.45e+03, Pressure: 4.03e+06, Temp: 8.27e-03, Mom: 5.26e-04
         Physical Weighted - Water: 0.027208, Energy: 0.029024, Pressure: 0.040259, Temp: 0.000005, Mom: 0.000105
  Valid - Total: 1.853035
         MSE - Surface: 0.642748, Upper Air: 0.493271
         Focus - Raw: 2.787306, Weighted: 0.278731
         Tweedie - Raw: 1.98e-02, Weighted: 0.237371
         Physical Raw - Water: 3.37e-03, Energy: 1.74e+03, Pressure: 1.39e+07, Temp: 9.76e-04, Mom: 5.84e-04
         Physical Weighted - Water: 0.026945, Energy: 0.034710, Pressure: 0.139142, Temp: 0.000001, Mom: 0.000117
Epoch 39/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:17<00:00,  5.28s/it, loss=1.7126, surf=0.5085, upper=0.5653, wind=E]
Epoch 39/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.39s/it, loss=2.3410, surf=1.0450, upper=0.5113]

Epoch 39/50
  Train - Total: 1.597685
         MSE - Surface: 0.584127, Upper Air: 0.457933
         Focus - Raw: 2.482906, Weighted: 0.248291
         Tweedie - Raw: 1.80e-02, Weighted: 0.216153
         Physical Raw - Water: 3.71e-03, Energy: 1.06e+03, Pressure: 4.03e+06, Temp: 2.35e-03, Mom: 4.11e-04
         Physical Weighted - Water: 0.029682, Energy: 0.021123, Pressure: 0.040293, Temp: 0.000001, Mom: 0.000082
  Valid - Total: 1.864115
         MSE - Surface: 0.631199, Upper Air: 0.494737
         Focus - Raw: 2.795634, Weighted: 0.279563
         Tweedie - Raw: 2.28e-02, Weighted: 0.273475
         Physical Raw - Water: 3.61e-03, Energy: 9.77e+02, Pressure: 1.37e+07, Temp: 4.26e-03, Mom: 5.29e-04
         Physical Weighted - Water: 0.028878, Energy: 0.019532, Pressure: 0.136622, Temp: 0.000003, Mom: 0.000106
Epoch 40/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.45s/it, loss=1.5313, surf=0.4857, upper=0.4865, wind=E]
Epoch 40/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.35s/it, loss=2.4028, surf=1.0862, upper=0.5161]

Epoch 40/50
  Train - Total: 1.613132
         MSE - Surface: 0.597418, Upper Air: 0.459162
         Focus - Raw: 2.482774, Weighted: 0.248277
         Tweedie - Raw: 1.83e-02, Weighted: 0.220163
         Physical Raw - Water: 3.54e-03, Energy: 9.13e+02, Pressure: 4.14e+06, Temp: 3.46e-03, Mom: 5.27e-04
         Physical Weighted - Water: 0.028311, Energy: 0.018267, Pressure: 0.041426, Temp: 0.000002, Mom: 0.000105
  Valid - Total: 1.871007
         MSE - Surface: 0.638913, Upper Air: 0.496606
         Focus - Raw: 2.821384, Weighted: 0.282138
         Tweedie - Raw: 2.03e-02, Weighted: 0.243057
         Physical Raw - Water: 3.02e-03, Energy: 1.01e+03, Pressure: 1.66e+07, Temp: 4.31e-02, Mom: 9.58e-04
         Physical Weighted - Water: 0.024123, Energy: 0.020174, Pressure: 0.165778, Temp: 0.000026, Mom: 0.000192
Epoch 41/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:22<00:00,  5.50s/it, loss=1.6756, surf=0.6016, upper=0.5104, wind=E]
Epoch 41/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.46s/it, loss=2.3389, surf=1.0426, upper=0.5149]

Epoch 41/50
  Train - Total: 1.592707
         MSE - Surface: 0.583254, Upper Air: 0.456600
         Focus - Raw: 2.485418, Weighted: 0.248542
         Tweedie - Raw: 1.85e-02, Weighted: 0.221496
         Physical Raw - Water: 3.31e-03, Energy: 8.70e+02, Pressure: 3.89e+06, Temp: 6.23e-03, Mom: 4.06e-04
         Physical Weighted - Water: 0.026469, Energy: 0.017400, Pressure: 0.038861, Temp: 0.000004, Mom: 0.000081
  Valid - Total: 1.844004
         MSE - Surface: 0.624617, Upper Air: 0.495603
         Focus - Raw: 2.784036, Weighted: 0.278404
         Tweedie - Raw: 1.99e-02, Weighted: 0.238684
         Physical Raw - Water: 2.90e-03, Energy: 1.66e+03, Pressure: 1.50e+07, Temp: 9.62e-04, Mom: 7.17e-04
         Physical Weighted - Water: 0.023188, Energy: 0.033220, Pressure: 0.150144, Temp: 0.000001, Mom: 0.000143
Epoch 42/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:14<00:00,  5.17s/it, loss=1.4294, surf=0.5286, upper=0.3959, wind=E]
Epoch 42/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.38s/it, loss=2.4092, surf=1.0732, upper=0.5139]

Epoch 42/50
  Train - Total: 1.588974
         MSE - Surface: 0.584067, Upper Air: 0.457148
         Focus - Raw: 2.470619, Weighted: 0.247062
         Tweedie - Raw: 1.79e-02, Weighted: 0.215187
         Physical Raw - Water: 3.29e-03, Energy: 1.08e+03, Pressure: 3.75e+06, Temp: 3.80e-03, Mom: 7.41e-04
         Physical Weighted - Water: 0.026292, Energy: 0.021581, Pressure: 0.037487, Temp: 0.000002, Mom: 0.000148
  Valid - Total: 1.895369
         MSE - Surface: 0.639667, Upper Air: 0.493277
         Focus - Raw: 2.835670, Weighted: 0.283567
         Tweedie - Raw: 2.33e-02, Weighted: 0.280109
         Physical Raw - Water: 3.86e-03, Energy: 9.75e+02, Pressure: 1.48e+07, Temp: 3.02e-02, Mom: 6.17e-04
         Physical Weighted - Water: 0.030912, Energy: 0.019498, Pressure: 0.148197, Temp: 0.000018, Mom: 0.000123
Epoch 43/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.39s/it, loss=1.3663, surf=0.4695, upper=0.3854, wind=E]
Epoch 43/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.36s/it, loss=2.3977, surf=1.1065, upper=0.5130]

Epoch 43/50
  Train - Total: 1.580805
         MSE - Surface: 0.578357, Upper Air: 0.456167
         Focus - Raw: 2.467512, Weighted: 0.246751
         Tweedie - Raw: 1.78e-02, Weighted: 0.213493
         Physical Raw - Water: 3.19e-03, Energy: 1.12e+03, Pressure: 3.80e+06, Temp: 4.97e-03, Mom: 4.76e-04
         Physical Weighted - Water: 0.025497, Energy: 0.022401, Pressure: 0.038041, Temp: 0.000003, Mom: 0.000095
  Valid - Total: 1.844411
         MSE - Surface: 0.641216, Upper Air: 0.496033
         Focus - Raw: 2.800684, Weighted: 0.280068
         Tweedie - Raw: 2.05e-02, Weighted: 0.245669
         Physical Raw - Water: 3.00e-03, Energy: 1.18e+03, Pressure: 1.34e+07, Temp: 2.64e-03, Mom: 5.80e-04
         Physical Weighted - Water: 0.023997, Energy: 0.023689, Pressure: 0.133622, Temp: 0.000002, Mom: 0.000116
Epoch 44/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:21<00:00,  5.46s/it, loss=1.5055, surf=0.4621, upper=0.4657, wind=E]
Epoch 44/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.4155, surf=1.0932, upper=0.5141]

Epoch 44/50
  Train - Total: 1.566803
         MSE - Surface: 0.570020, Upper Air: 0.455662
         Focus - Raw: 2.470157, Weighted: 0.247016
         Tweedie - Raw: 1.78e-02, Weighted: 0.213380
         Physical Raw - Water: 3.20e-03, Energy: 8.81e+02, Pressure: 3.74e+06, Temp: 3.21e-03, Mom: 5.44e-04
         Physical Weighted - Water: 0.025608, Energy: 0.017613, Pressure: 0.037393, Temp: 0.000002, Mom: 0.000109
  Valid - Total: 1.851822
         MSE - Surface: 0.628073, Upper Air: 0.497923
         Focus - Raw: 2.803219, Weighted: 0.280322
         Tweedie - Raw: 2.00e-02, Weighted: 0.240280
         Physical Raw - Water: 2.91e-03, Energy: 1.63e+03, Pressure: 1.49e+07, Temp: 7.17e-03, Mom: 1.02e-03
         Physical Weighted - Water: 0.023291, Energy: 0.032640, Pressure: 0.149085, Temp: 0.000004, Mom: 0.000204
Epoch 45/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:15<00:00,  5.22s/it, loss=1.4245, surf=0.5185, upper=0.4056, wind=E]
Epoch 45/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.4086, surf=1.1213, upper=0.5110]

Epoch 45/50
  Train - Total: 1.559549
         MSE - Surface: 0.568169, Upper Air: 0.456222
         Focus - Raw: 2.443736, Weighted: 0.244374
         Tweedie - Raw: 1.77e-02, Weighted: 0.212241
         Physical Raw - Water: 3.00e-03, Energy: 8.30e+02, Pressure: 3.79e+06, Temp: 7.45e-03, Mom: 5.14e-04
         Physical Weighted - Water: 0.023965, Energy: 0.016597, Pressure: 0.037875, Temp: 0.000004, Mom: 0.000103
  Valid - Total: 1.862109
         MSE - Surface: 0.642058, Upper Air: 0.495281
         Focus - Raw: 2.783296, Weighted: 0.278330
         Tweedie - Raw: 2.02e-02, Weighted: 0.242642
         Physical Raw - Water: 2.77e-03, Energy: 1.38e+03, Pressure: 1.54e+07, Temp: 1.69e-02, Mom: 5.32e-04
         Physical Weighted - Water: 0.022196, Energy: 0.027694, Pressure: 0.153792, Temp: 0.000010, Mom: 0.000106
Epoch 46/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:16<00:00,  5.26s/it, loss=1.5677, surf=0.6150, upper=0.4178, wind=E]
Epoch 46/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.35s/it, loss=2.4701, surf=1.1661, upper=0.5107]

Epoch 46/50
  Train - Total: 1.566851
         MSE - Surface: 0.571245, Upper Air: 0.456030
         Focus - Raw: 2.454977, Weighted: 0.245498
         Tweedie - Raw: 1.78e-02, Weighted: 0.213764
         Physical Raw - Water: 2.92e-03, Energy: 7.83e+02, Pressure: 4.12e+06, Temp: 5.71e-03, Mom: 3.52e-04
         Physical Weighted - Water: 0.023344, Energy: 0.015654, Pressure: 0.041242, Temp: 0.000003, Mom: 0.000070
  Valid - Total: 1.906744
         MSE - Surface: 0.671912, Upper Air: 0.493783
         Focus - Raw: 2.916117, Weighted: 0.291612
         Tweedie - Raw: 2.19e-02, Weighted: 0.262769
         Physical Raw - Water: 3.12e-03, Energy: 9.48e+02, Pressure: 1.43e+07, Temp: 7.92e-03, Mom: 5.83e-04
         Physical Weighted - Water: 0.024941, Energy: 0.018953, Pressure: 0.142654, Temp: 0.000005, Mom: 0.000117
Epoch 47/50 [Train]:  23%|██████████████████████████████████▌                                                                                                                   | 6/26 [01:08<02:05,  6.29s/it, loss=1.4507, surf=0.5292, upper=0.4261, winEpoch 47/50 [Train]:  27%|████████████████████████████████████████▍                                                                                                             | 7/26 [01:08<01:45,  5.54s/it, loss=1.4507, surf=0.5292, upper=0.4261, winEpoch 47/50 [Train]:  27%|████████████████████████████████████████▍                                                                                                             | 7/26 [01:12<01:45,  5.54s/it, loss=1.8643, surf=0.8469, upper=0.4808, winEpoch 47/50 [Train]:  31%|██████████████████████████████████████████████▏                                                                                                       | 8/26 [01:12<01:31,  5.08s/it, loss=1.8643, surf=0.8469, upper=0.4808, winEpoch 47/50 [Train]:  31%|██████████████████████████████████████████████▏                                                                                                       | 8/26 [01:16<01:31,  5.08s/it, loss=1.3266, surf=0.4573, upper=0.3806, winEpoch 47/50 [Train]:  35%|███████████████████████████████████████████████████▉                                                                                                  | 9/26 [01:16<01:20,  4.72s/it, loss=1.3266, surf=0.4573, upper=0.3806, winEpoch 47/50 [Train]:  35%|███████████████████████████████████████████████████▉                                                                                                  | 9/26 [01:20<01:20,  4.72s/it, loss=1.5562, surf=0.5979, upper=0.4289, winEpoch 47/50 [Train]:  38%|█████████████████████████████████████████████████████████▎                                                                                           | 10/26 [01:20<01:11,  4.49s/it, loss=1.5562, surf=0.5979, upper=0.4289, winEpoch 47/50 [Train]:  38%|█████████████████████████████████████████████████████████▎                                                                                           | 10/26 [01:24<01:11,  4.49s/it, loss=1.5472, surf=0.5804, upper=0.4481, winEpoch 47/50 [Train]:  42%|███████████████████████████████████████████████████████████████                                                                                      | 11/26 [01:24<01:04,  4.31s/it, loss=1.5472, surf=0.5804, upper=0.4481, winEpoch 47/50 [Train]:  42%|███████████████████████████████████████████████████████████████                                                                                      | 11/26 [01:28<01:04,  4.31s/it, loss=1.6186, surf=0.6356, upper=0.4362, winEpoch 47/50 [Train]:  46%|████████████████████████████████████████████████████████████████████▊                                                                                | 12/26 [01:28<00:58,  4.21s/it, loss=1.6186, surf=0.6356, upper=0.4362, winEpoch 47/50 [Train]:  46%|████████████████████████████████████████████████████████████████████▊                                                                                | 12/26 [01:32<00:58,  4.21s/it, loss=1.6381, surf=0.5370, upper=0.4999, winEpoch 47/50 [Train]:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 13/26 [01:32<00:53,  4.14s/it, loss=1.6381, surf=0.5370, upper=0.4999, winEpoch 47/50 [Train]:  50%|██████████████████████████████████████████████████████████████████████████▌                                                                          | 13/26 [01:36<00:53,  4.14s/it, loss=1.6413, surf=0.5154, upper=0.5214, winEpoch 47/50 [Train]:  54%|████████████████████████████████████████████████████████████████████████████████▏                                                                    | 14/26 [01:36<00:48,  4.08s/it, loss=1.6413, surf=0.5154, upper=0.5214, winEpoch 47/50 [Train]:  54%|████████████████████████████████████████████████████████████████████████████████▏                                                                    | 14/26 [01:40<00:48,  4.08s/it, loss=1.3040, surf=0.4233, upper=0.4177, winEpoch 47/50 [Train]:  58%|█████████████████████████████████████████████████████████████████████████████████████▉                                                               | 15/26 [01:40<00:44,  4.05s/it, loss=1.3040, surf=0.4233, upper=0.4177, winEpoch 47/50 [Train]:  58%|█████████████████████████████████████████████████████████████████████████████████████▉                                                               | 15/26 [01:44<00:44,  4.05s/it, loss=1.8829, surf=0.7082, upper=0.5522, winEpoch 47/50 [Train]:  62%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                         | 16/26 [01:44<00:40,  4.02s/it, loss=1.8829, surf=0.7082, upper=0.5522, winEpoch 47/50 [Train]:  62%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                         | 16/26 [01:48<00:40,  4.02s/it, loss=1.5288, surf=0.6331, upper=0.4091, winEpoch 47/50 [Train]:  65%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 17/26 [01:48<00:36,  4.01s/it, loss=1.5288, surf=0.6331, upper=0.4091, winEpoch 47/50 [Train]:  65%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 17/26 [01:52<00:36,  4.01s/it, loss=1.8271, surf=0.7275, upper=0.5148, winEpoch 47/50 [Train]:  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                             | 18/26 [01:52<00:32,  4.03s/it, loss=1.8271, surf=0.7275, upper=0.5148, winEpoch 47/50 [Train]:  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                             | 18/26 [01:56<00:32,  4.03s/it, loss=1.5458, surf=0.5833, upper=0.4166, winEpoch 47/50 [Train]:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 19/26 [01:56<00:27,  4.00s/it, loss=1.5458, surf=0.5833, upper=0.4166, winEpoch 47/50 [Train]:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 19/26 [02:00<00:27,  4.00s/it, loss=1.6528, surf=0.5693, upper=0.4853, winEpoch 47/50 [Train]:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 20/26 [02:00<00:23,  3.99s/it, loss=1.6528, surf=0.5693, upper=0.4853, winEpoch 47/50 [Train]:  77%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 20/26 [02:04<00:23,  3.99s/it, loss=1.3766, surf=0.4589, upper=0.4063, winEpoch 47/50 [Train]:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                            | 21/26 [02:04<00:19,  3.99s/it, loss=1.3766, surf=0.4589, upper=0.4063, winEpoch 47/50 [Train]:  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                            | 21/26 [02:08<00:19,  3.99s/it, loss=1.4914, surf=0.5611, upper=0.3961, winEpoch 47/50 [Train]:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                       | 22/26 [02:08<00:15,  3.98s/it, loss=1.4914, surf=0.5611, upper=0.3961, winEpoch 47/50 [Train]:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                       | 22/26 [02:12<00:15,  3.98s/it, loss=1.4374, surf=0.5551, upper=0.4040, winEpoch 47/50 [Train]:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 23/26 [02:12<00:11,  3.98s/it, loss=1.4374, surf=0.5551, upper=0.4040, winEpoch 47/50 [Train]:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 23/26 [02:16<00:11,  3.98s/it, loss=1.6324, surf=0.6298, upper=0.4294, winEpoch 47/50 [Train]:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 24/26 [02:16<00:07,  3.98s/it, loss=1.6324, surf=0.6298, upper=0.4294, winEpoch 47/50 [Train]:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 24/26 [02:20<00:07,  3.98s/it, loss=1.4436, surf=0.5182, upper=0.3991, winEpoch 47/50 [Train]:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 25/26 [02:20<00:03,  3.99s/it, loss=1.4436, surf=0.5182, upper=0.3991, winEpoch 47/50 [Train]:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎     | 25/26 [02:24<00:03,  3.99s/it, loss=1.7332, surf=0.5983, upper=0.5020, winEpoch 47/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:24<00:00,  3.97s/it, loss=1.7332, surf=0.5983, upper=0.5020, winEpoch 47/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:24<00:00,  5.55s/it, loss=1.7332, surf=0.5983, upper=0.5020, wind=E]
Epoch 47/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:34<00:00,  3.47s/it, loss=2.4128, surf=1.1221, upper=0.5112]

Epoch 47/50
  Train - Total: 1.580962
         MSE - Surface: 0.573477, Upper Air: 0.455335
         Focus - Raw: 2.466560, Weighted: 0.246656
         Tweedie - Raw: 1.80e-02, Weighted: 0.216309
         Physical Raw - Water: 3.12e-03, Energy: 1.21e+03, Pressure: 3.98e+06, Temp: 3.69e-03, Mom: 4.39e-04
         Physical Weighted - Water: 0.024990, Energy: 0.024290, Pressure: 0.039815, Temp: 0.000002, Mom: 0.000088
  Valid - Total: 1.845268
         MSE - Surface: 0.633934, Upper Air: 0.493305
         Focus - Raw: 2.838927, Weighted: 0.283893
         Tweedie - Raw: 2.04e-02, Weighted: 0.244419
         Physical Raw - Water: 2.70e-03, Energy: 1.16e+03, Pressure: 1.45e+07, Temp: 3.56e-03, Mom: 5.20e-04
         Physical Weighted - Water: 0.021585, Energy: 0.023143, Pressure: 0.144883, Temp: 0.000002, Mom: 0.000104
Epoch 48/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:23<00:00,  5.51s/it, loss=1.4210, surf=0.4927, upper=0.4047, wind=E]
Epoch 48/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.3782, surf=1.0778, upper=0.5124]

Epoch 48/50
  Train - Total: 1.572185
         MSE - Surface: 0.570943, Upper Air: 0.455181
         Focus - Raw: 2.451126, Weighted: 0.245113
         Tweedie - Raw: 1.78e-02, Weighted: 0.213192
         Physical Raw - Water: 2.87e-03, Energy: 1.22e+03, Pressure: 4.04e+06, Temp: 3.92e-03, Mom: 3.22e-04
         Physical Weighted - Water: 0.022975, Energy: 0.024365, Pressure: 0.040350, Temp: 0.000002, Mom: 0.000064
  Valid - Total: 1.887468
         MSE - Surface: 0.641822, Upper Air: 0.494014
         Focus - Raw: 2.846659, Weighted: 0.284666
         Tweedie - Raw: 2.16e-02, Weighted: 0.259748
         Physical Raw - Water: 2.78e-03, Energy: 9.73e+02, Pressure: 1.65e+07, Temp: 4.89e-03, Mom: 4.05e-04
         Physical Weighted - Water: 0.022257, Energy: 0.019465, Pressure: 0.165414, Temp: 0.000003, Mom: 0.000081
Epoch 49/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:20<00:00,  5.42s/it, loss=1.4909, surf=0.5598, upper=0.4162, wind=E]
Epoch 49/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.37s/it, loss=2.3772, surf=1.0908, upper=0.5137]

Epoch 49/50
  Train - Total: 1.552410
         MSE - Surface: 0.560217, Upper Air: 0.456658
         Focus - Raw: 2.437168, Weighted: 0.243717
         Tweedie - Raw: 1.76e-02, Weighted: 0.211025
         Physical Raw - Water: 3.01e-03, Energy: 1.06e+03, Pressure: 3.54e+06, Temp: 5.35e-03, Mom: 3.14e-04
         Physical Weighted - Water: 0.024117, Energy: 0.021249, Pressure: 0.035361, Temp: 0.000003, Mom: 0.000063
  Valid - Total: 1.806517
         MSE - Surface: 0.621321, Upper Air: 0.494871
         Focus - Raw: 2.773241, Weighted: 0.277324
         Tweedie - Raw: 2.00e-02, Weighted: 0.240011
         Physical Raw - Water: 2.89e-03, Energy: 1.32e+03, Pressure: 1.23e+07, Temp: 2.38e-02, Mom: 4.57e-04
         Physical Weighted - Water: 0.023122, Energy: 0.026447, Pressure: 0.123315, Temp: 0.000014, Mom: 0.000091
Epoch 50/50 [Train]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [02:25<00:00,  5.60s/it, loss=1.5060, surf=0.6086, upper=0.4104, wind=E]
Epoch 50/50 [Valid]: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:33<00:00,  3.34s/it, loss=2.3449, surf=1.0414, upper=0.5100]

Epoch 50/50
  Train - Total: 1.549696
         MSE - Surface: 0.562485, Upper Air: 0.455372
         Focus - Raw: 2.448647, Weighted: 0.244865
         Tweedie - Raw: 1.77e-02, Weighted: 0.212343
         Physical Raw - Water: 2.80e-03, Energy: 7.08e+02, Pressure: 3.80e+06, Temp: 4.74e-03, Mom: 3.10e-04
         Physical Weighted - Water: 0.022383, Energy: 0.014165, Pressure: 0.038019, Temp: 0.000003, Mom: 0.000062
  Valid - Total: 1.807309
         MSE - Surface: 0.610312, Upper Air: 0.492947
         Focus - Raw: 2.749198, Weighted: 0.274920
         Tweedie - Raw: 2.02e-02, Weighted: 0.242017
         Physical Raw - Water: 2.85e-03, Energy: 1.71e+03, Pressure: 1.30e+07, Temp: 2.78e-02, Mom: 3.23e-04
         Physical Weighted - Water: 0.022766, Energy: 0.034184, Pressure: 0.130083, Temp: 0.000017, Mom: 0.000065
  Saved checkpoint: checkpoints_v3_5/model_v3_5_epoch50.pth
Training completed!